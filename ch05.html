
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Chapter 05: Coding by Composing · Professor Frisby's Mostly Adequate Guide to Functional Programming</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-exercises/exercises.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="ch05.html" />
    
    
    <link rel="prev" href="ch04.md-kr" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="ch01-kr.html">
            
                <a href="ch01-kr.html">
            
                    
                    01 장: 우리는 무엇을 하고 있나?
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="ch01-kr.html">
            
                <a href="ch01-kr.html#소개">
            
                    
                    소개
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="ch01-kr.html">
            
                <a href="ch01-kr.html#짧은-만남">
            
                    
                    짧은 만남
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="ch02-kr.html">
            
                <a href="ch02-kr.html">
            
                    
                    02 장: 일급 함수
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="ch02-kr.html">
            
                <a href="ch02-kr.html#복습-시간">
            
                    
                    복습 시간
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="ch02-kr.html">
            
                <a href="ch02-kr.html#일급-함수의-장점">
            
                    
                    일급 함수의 장점
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="ch03-kr.html">
            
                <a href="ch03-kr.html">
            
                    
                    03 장: 순수 함수와 순수한 기쁨을
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="ch03-kr.html">
            
                <a href="ch03-kr.html#한번-더-순수함에-대하여">
            
                    
                    한번 더 순수함에 대하여
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="ch03-kr.html">
            
                <a href="ch03-kr.html#부수효과는-를-포함할-수-있어요">
            
                    
                    부수효과는 ...를 포함할 수 있어요
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="ch03-kr.html">
            
                <a href="ch03-kr.html#중학교-2학년-수학">
            
                    
                    중학교 2학년 수학
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="ch03-kr.html">
            
                <a href="ch03-kr.html#순수성의-예">
            
                    
                    순수성의 예
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="ch03-kr.html">
            
                <a href="ch03-kr.html#요약">
            
                    
                    요약
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="ch04-kr.html">
            
                <a href="ch04-kr.html">
            
                    
                    04 장: 커링
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="ch04-kr.html">
            
                <a href="ch04-kr.html#cant-live-if-livin-is-without-you">
            
                    
                    Can't Live If Livin' Is without You
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="ch04-kr.html">
            
                <a href="ch04-kr.html#말장난-조금-더--특별한-소스">
            
                    
                    말장난 조금 더 / 특별한 소스
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="ch04.md-kr">
            
                <span>
            
                    
                    요약
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="ch04.md-kr">
            
                <span>
            
                    
                    연습문제
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.6" data-path="ch05.html">
            
                <a href="ch05.html">
            
                    
                    Chapter 05: Coding by Composing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="ch05.html">
            
                <a href="ch05.html#functional-husbandry">
            
                    
                    Functional Husbandry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="ch05.html">
            
                <a href="ch05.html#pointfree">
            
                    
                    Pointfree
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="ch05.html">
            
                <a href="ch05.html#debugging">
            
                    
                    Debugging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="ch05.html">
            
                <a href="ch05.html#category-theory">
            
                    
                    Category Theory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="ch05.html">
            
                <a href="ch05.html#in-summary">
            
                    
                    In Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="ch05.html">
            
                <a href="ch05.html#exercises">
            
                    
                    Exercises
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="ch06.html">
            
                <a href="ch06.html">
            
                    
                    Chapter 06: Example Application
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="ch06.html">
            
                <a href="ch06.html#declarative-coding">
            
                    
                    Declarative Coding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="ch06.html">
            
                <a href="ch06.html#a-flickr-of-functional-programming">
            
                    
                    A Flickr of Functional Programming
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="ch06.html">
            
                <a href="ch06.html#a-principled-refactor">
            
                    
                    A Principled Refactor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="ch06.html">
            
                <a href="ch06.html#in-summary">
            
                    
                    In Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="ch07-kr.html">
            
                <a href="ch07-kr.html">
            
                    
                    07 장: 힌들리-밀너와 나
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="ch07-kr.html">
            
                <a href="ch07-kr.html#당신은-무슨-타입인가요">
            
                    
                    당신은 무슨 타입인가요?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="ch07-kr.html">
            
                <a href="ch07-kr.html#비밀-이야기">
            
                    
                    비밀 이야기
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="ch07-kr.html">
            
                <a href="ch07-kr.html#가능성을-높이기">
            
                    
                    가능성을 높이기
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="ch07-kr.html">
            
                <a href="ch07-kr.html#공짜로-정리-얻기">
            
                    
                    공짜로 정리 얻기
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="ch07-kr.html">
            
                <a href="ch07-kr.html#제약">
            
                    
                    제약
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="ch07-kr.html">
            
                <a href="ch07-kr.html#요약">
            
                    
                    요약
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="ch08.html">
            
                <a href="ch08.html">
            
                    
                    Chapter 08: Tupperware
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="ch08.html">
            
                <a href="ch08.html#the-mighty-container">
            
                    
                    The Mighty Container
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="ch08.html">
            
                <a href="ch08.html#my-first-functor">
            
                    
                    My First Functor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="ch08.html">
            
                <a href="ch08.html#schrödingers-maybe">
            
                    
                    Schrödinger's Maybe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="ch08.html">
            
                <a href="ch08.html#use-cases">
            
                    
                    Use Cases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="ch08.html">
            
                <a href="ch08.html#releasing-the-value">
            
                    
                    Releasing the Value
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="ch08.html">
            
                <a href="ch08.html#pure-error-handling">
            
                    
                    Pure Error Handling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="ch08.html">
            
                <a href="ch08.html#old-mcdonald-had-effects">
            
                    
                    Old McDonald Had Effects...
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="ch08.html">
            
                <a href="ch08.html#asynchronous-tasks">
            
                    
                    Asynchronous Tasks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="ch08.html">
            
                <a href="ch08.html#a-spot-of-theory">
            
                    
                    A Spot of Theory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.10" data-path="ch08.html">
            
                <a href="ch08.html#in-summary">
            
                    
                    In Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.11" data-path="ch08.html">
            
                <a href="ch08.html#exercises">
            
                    
                    Exercises
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="ch09.html">
            
                <a href="ch09.html">
            
                    
                    Chapter 09: Monadic Onions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="ch09.html">
            
                <a href="ch09.html#pointy-functor-factory">
            
                    
                    Pointy Functor Factory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="ch09.html">
            
                <a href="ch09.html#mixing-metaphors">
            
                    
                    Mixing Metaphors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="ch09.html">
            
                <a href="ch09.html#my-chain-hits-my-chest">
            
                    
                    My Chain Hits My Chest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="ch09.html">
            
                <a href="ch09.html#power-trip">
            
                    
                    Power Trip
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="ch09.html">
            
                <a href="ch09.html#theory">
            
                    
                    Theory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="ch09.html">
            
                <a href="ch09.html#in-summary">
            
                    
                    In Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="ch09.html">
            
                <a href="ch09.html#exercises">
            
                    
                    Exercises
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="ch10.html">
            
                <a href="ch10.html">
            
                    
                    Chapter 10: Applicative Functors
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="ch10.html">
            
                <a href="ch10.html#applying-applicatives">
            
                    
                    Applying Applicatives
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="ch10.html">
            
                <a href="ch10.html#ships-in-bottles">
            
                    
                    Ships in Bottles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="ch10.html">
            
                <a href="ch10.html#coordination-motivation">
            
                    
                    Coordination Motivation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="ch10.html">
            
                <a href="ch10.html#bro-do-you-even-lift">
            
                    
                    Bro, Do You Even Lift?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="ch10.html">
            
                <a href="ch10.html#operators">
            
                    
                    Operators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.6" data-path="ch10.html">
            
                <a href="ch10.html#free-can-openers">
            
                    
                    Free Can Openers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7" data-path="ch10.html">
            
                <a href="ch10.html#laws">
            
                    
                    Laws
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.8" data-path="ch10.html">
            
                <a href="ch10.html#in-summary">
            
                    
                    In Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9" data-path="ch10.html">
            
                <a href="ch10.html#exercises">
            
                    
                    Exercises
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="ch11.html">
            
                <a href="ch11.html">
            
                    
                    Chapter 11: Transform Again, Naturally
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="ch11.html">
            
                <a href="ch11.html#curse-this-nest">
            
                    
                    Curse This Nest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="ch11.html">
            
                <a href="ch11.html#a-situational-comedy">
            
                    
                    A Situational Comedy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="ch11.html">
            
                <a href="ch11.html#all-natural">
            
                    
                    All Natural
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="ch11.html">
            
                <a href="ch11.html#principled-type-conversions">
            
                    
                    Principled Type Conversions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="ch11.html">
            
                <a href="ch11.html#feature-envy">
            
                    
                    Feature Envy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="ch11.html">
            
                <a href="ch11.html#isomorphic-javascript">
            
                    
                    Isomorphic JavaScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="ch11.html">
            
                <a href="ch11.html#a-broader-definition">
            
                    
                    A Broader Definition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.8" data-path="ch11.html">
            
                <a href="ch11.html#one-nesting-solution">
            
                    
                    One Nesting Solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.9" data-path="ch11.html">
            
                <a href="ch11.html#in-summary">
            
                    
                    In Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.10" data-path="ch11.html">
            
                <a href="ch11.html#exercises">
            
                    
                    Exercises
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="ch12.html">
            
                <a href="ch12.html">
            
                    
                    Chapter 12: Traversing the Stone
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="ch12.html">
            
                <a href="ch12.html#types-n-types">
            
                    
                    Types n' Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="ch12.html">
            
                <a href="ch12.html#type-feng-shui">
            
                    
                    Type Feng Shui
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="ch12.html">
            
                <a href="ch12.html#effect-assortment">
            
                    
                    Effect Assortment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.4" data-path="ch12.html">
            
                <a href="ch12.html#waltz-of-the-types">
            
                    
                    Waltz of the Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.5" data-path="ch12.html">
            
                <a href="ch12.html#no-law-and-order">
            
                    
                    No Law and Order
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.6" data-path="ch12.html">
            
                <a href="ch12.html#in-summary">
            
                    
                    In Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.7" data-path="ch12.html">
            
                <a href="ch12.html#exercises">
            
                    
                    Exercises
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="appendix_a.html">
            
                <a href="appendix_a.html">
            
                    
                    Appendix A: Essential Functions Support
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="appendix_a.html">
            
                <a href="appendix_a.html#always">
            
                    
                    always
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="appendix_a.html">
            
                <a href="appendix_a.html#compose">
            
                    
                    compose
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="appendix_a.html">
            
                <a href="appendix_a.html#curry">
            
                    
                    curry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.4" data-path="appendix_a.html">
            
                <a href="appendix_a.html#either">
            
                    
                    either
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.5" data-path="appendix_a.html">
            
                <a href="appendix_a.html#identity">
            
                    
                    identity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.6" data-path="appendix_a.html">
            
                <a href="appendix_a.html#inspect">
            
                    
                    inspect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.7" data-path="appendix_a.html">
            
                <a href="appendix_a.html#left">
            
                    
                    left
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.8" data-path="appendix_a.html">
            
                <a href="appendix_a.html#lifta">
            
                    
                    liftA*
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.9" data-path="appendix_a.html">
            
                <a href="appendix_a.html#maybe">
            
                    
                    maybe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.10" data-path="appendix_a.html">
            
                <a href="appendix_a.html#nothing">
            
                    
                    nothing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.11" data-path="appendix_a.html">
            
                <a href="appendix_a.html#reject">
            
                    
                    reject
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="appendix_b.html">
            
                <a href="appendix_b.html">
            
                    
                    Appendix B: Algebraic Structures Support
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="appendix_b.html">
            
                <a href="appendix_b.html#compose">
            
                    
                    Compose
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="appendix_b.html">
            
                <a href="appendix_b.html#either">
            
                    
                    Either
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="appendix_b.html">
            
                <a href="appendix_b.html#identity">
            
                    
                    Identity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4" data-path="appendix_b.html">
            
                <a href="appendix_b.html#io">
            
                    
                    IO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.5" data-path="appendix_b.html">
            
                <a href="appendix_b.html#list">
            
                    
                    List
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.6" data-path="appendix_b.html">
            
                <a href="appendix_b.html#map">
            
                    
                    Map
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7" data-path="appendix_b.html">
            
                <a href="appendix_b.html#maybe">
            
                    
                    Maybe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.8" data-path="appendix_b.html">
            
                <a href="appendix_b.html#task">
            
                    
                    Task
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="appendix_c.html">
            
                <a href="appendix_c.html">
            
                    
                    Appendix C: Pointfree Utilities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="appendix_c.html">
            
                <a href="appendix_c.html#add">
            
                    
                    add
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="appendix_c.html">
            
                <a href="appendix_c.html#append">
            
                    
                    append
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3" data-path="appendix_c.html">
            
                <a href="appendix_c.html#chain">
            
                    
                    chain
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4" data-path="appendix_c.html">
            
                <a href="appendix_c.html#concat">
            
                    
                    concat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.5" data-path="appendix_c.html">
            
                <a href="appendix_c.html#eq">
            
                    
                    eq
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.6" data-path="appendix_c.html">
            
                <a href="appendix_c.html#filter">
            
                    
                    filter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.7" data-path="appendix_c.html">
            
                <a href="appendix_c.html#flip">
            
                    
                    flip
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.8" data-path="appendix_c.html">
            
                <a href="appendix_c.html#foreach">
            
                    
                    forEach
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.9" data-path="appendix_c.html">
            
                <a href="appendix_c.html#head">
            
                    
                    head
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.10" data-path="appendix_c.html">
            
                <a href="appendix_c.html#intercalate">
            
                    
                    intercalate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.11" data-path="appendix_c.html">
            
                <a href="appendix_c.html#join">
            
                    
                    join
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.12" data-path="appendix_c.html">
            
                <a href="appendix_c.html#last">
            
                    
                    last
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.13" data-path="appendix_c.html">
            
                <a href="appendix_c.html#map">
            
                    
                    map
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.14" data-path="appendix_c.html">
            
                <a href="appendix_c.html#match">
            
                    
                    match
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.15" data-path="appendix_c.html">
            
                <a href="appendix_c.html#prop">
            
                    
                    prop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.16" data-path="appendix_c.html">
            
                <a href="appendix_c.html#reduce">
            
                    
                    reduce
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.17" data-path="appendix_c.html">
            
                <a href="appendix_c.html#replace">
            
                    
                    replace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.18" data-path="appendix_c.html">
            
                <a href="appendix_c.html#safehead">
            
                    
                    safeHead
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.19" data-path="appendix_c.html">
            
                <a href="appendix_c.html#safelast">
            
                    
                    safeLast
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.20" data-path="appendix_c.html">
            
                <a href="appendix_c.html#safeprop">
            
                    
                    safeProp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.21" data-path="appendix_c.html">
            
                <a href="appendix_c.html#sequence">
            
                    
                    sequence
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.22" data-path="appendix_c.html">
            
                <a href="appendix_c.html#sortby">
            
                    
                    sortBy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.23" data-path="appendix_c.html">
            
                <a href="appendix_c.html#split">
            
                    
                    split
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.24" data-path="appendix_c.html">
            
                <a href="appendix_c.html#take">
            
                    
                    take
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.25" data-path="appendix_c.html">
            
                <a href="appendix_c.html#tolowercase">
            
                    
                    toLowerCase
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.26" data-path="appendix_c.html">
            
                <a href="appendix_c.html#tostring">
            
                    
                    toString
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.27" data-path="appendix_c.html">
            
                <a href="appendix_c.html#touppercase">
            
                    
                    toUpperCase
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.28" data-path="appendix_c.html">
            
                <a href="appendix_c.html#traverse">
            
                    
                    traverse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.29" data-path="appendix_c.html">
            
                <a href="appendix_c.html#unsafeperformio">
            
                    
                    unsafePerformIO
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Chapter 05: Coding by Composing</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="chapter-05-coding-by-composing">Chapter 05: Coding by Composing</h1>
<h2 id="functional-husbandry">Functional Husbandry</h2>
<p>Here&apos;s <code>compose</code>:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> compose = (...fns) =&gt; (...args) =&gt; fns.reduceRight((res, fn) =&gt; [fn.call(<span class="hljs-literal">null</span>, ...res)], args)[<span class="hljs-number">0</span>];
</code></pre>
<p>... Don&apos;t be scared! This is the level-9000-super-Saiyan-form of <em>compose</em>. For the sake of reasoning, let&apos;s drop the variadic implementation and consider a simpler form that can compose two functions together. Once you get your head around that, you can push the abstraction further and consider it simply works for any number of functions (we could even prove that)!
Here&apos;s a more friendly <em>compose</em> for you my dear readers:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> compose2 = (f, g) =&gt; x =&gt; f(g(x));
</code></pre>
<p><code>f</code> and <code>g</code> are functions and <code>x</code> is the value being &quot;piped&quot; through them.</p>
<p>Composition feels like function husbandry. You, breeder of functions, select two with traits you&apos;d like to combine and mash them together to spawn a brand new one. Usage is as follows:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> toUpperCase = x =&gt; x.toUpperCase();
<span class="hljs-keyword">const</span> exclaim = x =&gt; <span class="hljs-string">`<span class="hljs-subst">${x}</span>!`</span>;
<span class="hljs-keyword">const</span> shout = compose(exclaim, toUpperCase);

shout(<span class="hljs-string">&apos;send in the clowns&apos;</span>); <span class="hljs-comment">// &quot;SEND IN THE CLOWNS!&quot;</span>
</code></pre>
<p>The composition of two functions returns a new function. This makes perfect sense: composing two units of some type (in this case function) should yield a new unit of that very type. You don&apos;t plug two legos together and get a lincoln log. There is a theory here, some underlying law that we will discover in due time.</p>
<p>In our definition of <code>compose</code>, the <code>g</code> will run before the <code>f</code>, creating a right to left flow of data. This is much more readable than nesting a bunch of function calls. Without compose, the above would read:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> shout = x =&gt; exclaim(toUpperCase(x));
</code></pre>
<p>Instead of inside to outside, we run right to left, which I suppose is a step in the left direction (boo!). Let&apos;s look at an example where sequence matters:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> head = x =&gt; x[<span class="hljs-number">0</span>];
<span class="hljs-keyword">const</span> reverse = reduce((acc, x) =&gt; [x, ...acc], []);
<span class="hljs-keyword">const</span> last = compose(head, reverse);

last([<span class="hljs-string">&apos;jumpkick&apos;</span>, <span class="hljs-string">&apos;roundhouse&apos;</span>, <span class="hljs-string">&apos;uppercut&apos;</span>]); <span class="hljs-comment">// &apos;uppercut&apos;</span>
</code></pre>
<p><code>reverse</code> will turn the list around while <code>head</code> grabs the initial item. This results in an effective, albeit inefficient, <code>last</code> function. The sequence of functions in the composition should be apparent here. We could define a left to right version, however, we mirror the mathematical version much more closely as it stands. That&apos;s right, composition is straight from the math books. In fact, perhaps it&apos;s time to look at a property that holds for any composition.</p>
<pre><code class="lang-js"><span class="hljs-comment">// associativity</span>
compose(f, compose(g, h)) === compose(compose(f, g), h);
</code></pre>
<p>Composition is associative, meaning it doesn&apos;t matter how you group two of them. So, should we choose to uppercase the string, we can write:</p>
<pre><code class="lang-js">compose(toUpperCase, compose(head, reverse));
<span class="hljs-comment">// or</span>
compose(compose(toUpperCase, head), reverse);
</code></pre>
<p>Since it doesn&apos;t matter how we group our calls to <code>compose</code>, the result will be the same. That allows us to write a variadic compose and use it as follows:</p>
<pre><code class="lang-js"><span class="hljs-comment">// previously we&apos;d have to write two composes, but since it&apos;s associative, </span>
<span class="hljs-comment">// we can give compose as many fn&apos;s as we like and let it decide how to group them.</span>
<span class="hljs-keyword">const</span> arg = [<span class="hljs-string">&apos;jumpkick&apos;</span>, <span class="hljs-string">&apos;roundhouse&apos;</span>, <span class="hljs-string">&apos;uppercut&apos;</span>];
<span class="hljs-keyword">const</span> lastUpper = compose(toUpperCase, head, reverse);
<span class="hljs-keyword">const</span> loudLastUpper = compose(exclaim, toUpperCase, head, reverse);

lastUpper(arg); <span class="hljs-comment">// &apos;UPPERCUT&apos;</span>
loudLastUpper(arg); <span class="hljs-comment">// &apos;UPPERCUT!&apos;</span>
</code></pre>
<p>Applying the associative property gives us this flexibility and peace of mind that the result will be equivalent. The slightly more complicated variadic definition is included with the support libraries for this book and is the normal definition you&apos;ll find in libraries like <a href="https://lodash.com/" target="_blank">lodash</a>, <a href="https://underscorejs.org/" target="_blank">underscore</a>, and <a href="https://ramdajs.com/" target="_blank">ramda</a>.</p>
<p>One pleasant benefit of associativity is that any group of functions can be extracted and bundled together in their very own composition. Let&apos;s play with refactoring our previous example:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> loudLastUpper = compose(exclaim, toUpperCase, head, reverse);

<span class="hljs-comment">// -- or ---------------------------------------------------------------</span>

<span class="hljs-keyword">const</span> last = compose(head, reverse);
<span class="hljs-keyword">const</span> loudLastUpper = compose(exclaim, toUpperCase, last);

<span class="hljs-comment">// -- or ---------------------------------------------------------------</span>

<span class="hljs-keyword">const</span> last = compose(head, reverse);
<span class="hljs-keyword">const</span> angry = compose(exclaim, toUpperCase);
<span class="hljs-keyword">const</span> loudLastUpper = compose(angry, last);

<span class="hljs-comment">// more variations...</span>
</code></pre>
<p>There&apos;s no right or wrong answers - we&apos;re just plugging our legos together in whatever way we please. Usually it&apos;s best to group things in a reusable way like <code>last</code> and <code>angry</code>. If familiar with Fowler&apos;s &quot;<a href="https://martinfowler.com/books/refactoring.html" target="_blank">Refactoring</a>&quot;, one might recognize this process as &quot;<a href="https://refactoring.com/catalog/extractFunction.html" target="_blank">extract function</a>&quot;...except without all the object state to worry about.</p>
<h2 id="pointfree">Pointfree</h2>
<p>Pointfree style means never having to say your data. Excuse me. It means functions that never mention the data upon which they operate. First class functions, currying, and composition all play well together to create this style.</p>
<blockquote>
<p>Hint: Pointfree versions of <code>replace</code> &amp; <code>toLowerCase</code> are defined in the <a href="appendix_c.html">Appendix C -
Pointfree Utilities</a>. Do not hesitate to have a peek!</p>
</blockquote>
<pre><code class="lang-js"><span class="hljs-comment">// not pointfree because we mention the data: word</span>
<span class="hljs-keyword">const</span> snakeCase = word =&gt; word.toLowerCase().replace(<span class="hljs-regexp">/\s+/ig</span>, <span class="hljs-string">&apos;_&apos;</span>);

<span class="hljs-comment">// pointfree</span>
<span class="hljs-keyword">const</span> snakeCase = compose(replace(<span class="hljs-regexp">/\s+/ig</span>, <span class="hljs-string">&apos;_&apos;</span>), toLowerCase);
</code></pre>
<p>See how we partially applied <code>replace</code>? What we&apos;re doing is piping our data through each function of 1 argument. Currying allows us to prepare each function to just take its data, operate on it, and pass it along. Something else to notice is how we don&apos;t need the data to construct our function in the pointfree version, whereas in the pointful one, we must have our <code>word</code> available before anything else.</p>
<p>Let&apos;s look at another example.</p>
<pre><code class="lang-js"><span class="hljs-comment">// not pointfree because we mention the data: name</span>
<span class="hljs-keyword">const</span> initials = name =&gt; name.split(<span class="hljs-string">&apos; &apos;</span>).map(compose(toUpperCase, head)).join(<span class="hljs-string">&apos;. &apos;</span>);

<span class="hljs-comment">// pointfree</span>
<span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> we use &apos;intercalate&apos; from the appendix instead of &apos;join&apos; introduced in Chapter 09!</span>
<span class="hljs-keyword">const</span> initials = compose(intercalate(<span class="hljs-string">&apos;. &apos;</span>), map(compose(toUpperCase, head)), split(<span class="hljs-string">&apos; &apos;</span>));

initials(<span class="hljs-string">&apos;hunter stockton thompson&apos;</span>); <span class="hljs-comment">// &apos;H. S. T&apos;</span>
</code></pre>
<p>Pointfree code can again, help us remove needless names and keep us concise and generic. Pointfree is a good litmus test for functional code as it lets us know we&apos;ve got small functions that take input to output. One can&apos;t compose a while loop, for instance. Be warned, however, pointfree is a double-edged sword and can sometimes obfuscate intention. Not all functional code is pointfree and that is O.K. We&apos;ll shoot for it where we can and stick with normal functions otherwise.</p>
<h2 id="debugging">Debugging</h2>
<p>A common mistake is to compose something like <code>map</code>, a function of two arguments, without first partially applying it.</p>
<pre><code class="lang-js"><span class="hljs-comment">// wrong - we end up giving angry an array and we partially applied map with who knows what.</span>
<span class="hljs-keyword">const</span> latin = compose(map, angry, reverse);

latin([<span class="hljs-string">&apos;frog&apos;</span>, <span class="hljs-string">&apos;eyes&apos;</span>]); <span class="hljs-comment">// error</span>

<span class="hljs-comment">// right - each function expects 1 argument.</span>
<span class="hljs-keyword">const</span> latin = compose(map(angry), reverse);

latin([<span class="hljs-string">&apos;frog&apos;</span>, <span class="hljs-string">&apos;eyes&apos;</span>]); <span class="hljs-comment">// [&apos;EYES!&apos;, &apos;FROG!&apos;])</span>
</code></pre>
<p>If you are having trouble debugging a composition, we can use this helpful, but impure trace function to see what&apos;s going on.</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> trace = curry((tag, x) =&gt; {
  <span class="hljs-built_in">console</span>.log(tag, x);
  <span class="hljs-keyword">return</span> x;
});

<span class="hljs-keyword">const</span> dasherize = compose(
  intercalate(<span class="hljs-string">&apos;-&apos;</span>),
  toLower,
  split(<span class="hljs-string">&apos; &apos;</span>),
  replace(<span class="hljs-regexp">/\s{2,}/ig</span>, <span class="hljs-string">&apos; &apos;</span>),
);

dasherize(<span class="hljs-string">&apos;The world is a vampire&apos;</span>);
<span class="hljs-comment">// TypeError: Cannot read property &apos;apply&apos; of undefined</span>
</code></pre>
<p>Something is wrong here, let&apos;s <code>trace</code></p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> dasherize = compose(
  intercalate(<span class="hljs-string">&apos;-&apos;</span>),
  toLower,
  trace(<span class="hljs-string">&apos;after split&apos;</span>),
  split(<span class="hljs-string">&apos; &apos;</span>),
  replace(<span class="hljs-regexp">/\s{2,}/ig</span>, <span class="hljs-string">&apos; &apos;</span>),
);

dasherize(<span class="hljs-string">&apos;The world is a vampire&apos;</span>);
<span class="hljs-comment">// after split [ &apos;The&apos;, &apos;world&apos;, &apos;is&apos;, &apos;a&apos;, &apos;vampire&apos; ]</span>
</code></pre>
<p>Ah! We need to <code>map</code> this <code>toLower</code> since it&apos;s working on an array.</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> dasherize = compose(
  intercalate(<span class="hljs-string">&apos;-&apos;</span>),
  map(toLower),
  split(<span class="hljs-string">&apos; &apos;</span>),
  replace(<span class="hljs-regexp">/\s{2,}/ig</span>, <span class="hljs-string">&apos; &apos;</span>),
);

dasherize(<span class="hljs-string">&apos;The world is a vampire&apos;</span>); <span class="hljs-comment">// &apos;the-world-is-a-vampire&apos;</span>
</code></pre>
<p>The <code>trace</code> function allows us to view the data at a certain point for debugging purposes. Languages like Haskell and PureScript have similar functions for ease of development.</p>
<p>Composition will be our tool for constructing programs and, as luck would have it, is backed by a powerful theory that ensures things will work out for us. Let&apos;s examine this theory.</p>
<h2 id="category-theory">Category Theory</h2>
<p>Category theory is an abstract branch of mathematics that can formalize concepts from several different branches such as set theory, type theory, group theory, logic, and more. It primarily deals with objects, morphisms, and transformations, which mirrors programming quite closely. Here is a chart of the same concepts as viewed from each separate theory.</p>
<p><img src="images/cat_theory.png" alt="category theory"></p>
<p>Sorry, I didn&apos;t mean to frighten you. I don&apos;t expect you to be intimately familiar with all these concepts. My point is to show you how much duplication we have so you can see why category theory aims to unify these things.</p>
<p>In category theory, we have something called... a category. It is defined as a collection with the following components:</p>
<ul>
<li>A collection of objects</li>
<li>A collection of morphisms</li>
<li>A notion of composition on the morphisms</li>
<li>A distinguished morphism called identity</li>
</ul>
<p>Category theory is abstract enough to model many things, but let&apos;s apply this to types and functions, which is what we care about at the moment.</p>
<p><strong>A collection of objects</strong>
The objects will be data types. For instance, <code>String</code>, <code>Boolean</code>, <code>Number</code>, <code>Object</code>, etc. We often view data types as sets of all the possible values. One could look at <code>Boolean</code> as the set of <code>[true, false]</code> and <code>Number</code> as the set of all possible numeric values. Treating types as sets is useful because we can use set theory to work with them.</p>
<p><strong>A collection of morphisms</strong>
The morphisms will be our standard every day pure functions.</p>
<p><strong>A notion of composition on the morphisms</strong>
This, as you may have guessed, is our brand new toy - <code>compose</code>. We&apos;ve discussed that our <code>compose</code> function is associative which is no coincidence as it is a property that must hold for any composition in category theory.</p>
<p>Here is an image demonstrating composition:</p>
<p><img src="images/cat_comp1.png" alt="category composition 1">
<img src="images/cat_comp2.png" alt="category composition 2"></p>
<p>Here is a concrete example in code:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> g = x =&gt; x.length;
<span class="hljs-keyword">const</span> f = x =&gt; x === <span class="hljs-number">4</span>;
<span class="hljs-keyword">const</span> isFourLetterWord = compose(f, g);
</code></pre>
<p><strong>A distinguished morphism called identity</strong>
Let&apos;s introduce a useful function called <code>id</code>. This function simply takes some input and spits it back at you. Take a look:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> id = x =&gt; x;
</code></pre>
<p>You might ask yourself &quot;What in the bloody hell is that useful for?&quot;. We&apos;ll make extensive use of this function in the following chapters, but for now think of it as a function that can stand in for our value - a function masquerading as every day data.</p>
<p><code>id</code> must play nicely with compose. Here is a property that always holds for every unary (unary: a one-argument function) function f:</p>
<pre><code class="lang-js"><span class="hljs-comment">// identity</span>
compose(id, f) === compose(f, id) === f;
<span class="hljs-comment">// true</span>
</code></pre>
<p>Hey, it&apos;s just like the identity property on numbers! If that&apos;s not immediately clear, take some time with it. Understand the futility. We&apos;ll be seeing <code>id</code> used all over the place soon, but for now we see it&apos;s a function that acts as a stand in for a given value. This is quite useful when writing pointfree code.</p>
<p>So there you have it, a category of types and functions. If this is your first introduction, I imagine you&apos;re still a little fuzzy on what a category is and why it&apos;s useful. We will build upon this knowledge throughout the book. As of right now, in this chapter, on this line, you can at least see it as providing us with some wisdom regarding composition - namely, the associativity and identity properties.</p>
<p>What are some other categories, you ask? Well, we can define one for directed graphs with nodes being objects, edges being morphisms, and composition just being path concatenation. We can define with Numbers as objects and <code>&gt;=</code> as morphisms (actually any partial or total order can be a category). There are heaps of categories, but for the purposes of this book, we&apos;ll only concern ourselves with the one defined above. We have sufficiently skimmed the surface and must move on.</p>
<h2 id="in-summary">In Summary</h2>
<p>Composition connects our functions together like a series of pipes. Data will flow through our application as it must - pure functions are input to output after all, so breaking this chain would disregard output, rendering our software useless.</p>
<p>We hold composition as a design principle above all others. This is because it keeps our app simple and reasonable. Category theory will play a big part in app architecture, modelling side effects, and ensuring correctness.</p>
<p>We are now at a point where it would serve us well to see some of this in practice. Let&apos;s make an example application.</p>
<p><a href="ch06.html">Chapter 06: Example Application</a></p>
<h2 id="exercises">Exercises</h2>
<p>In each following exercise, we&apos;ll consider Car objects with the following shape:</p>
<pre><code class="lang-js">{
  name: <span class="hljs-string">&apos;Aston Martin One-77&apos;</span>,
  horsepower: <span class="hljs-number">750</span>,
  dollar_value: <span class="hljs-number">1850000</span>,
  in_stock: <span class="hljs-literal">true</span>,
}
</code></pre>
<p><div class="exercise">
	<div class="header">Exercise</div>
	<div class="alert alert-success">
	    <b>Correct!</b>
	</div>

	<div class="alert alert-danger error-message">
	    <b>False!</b>
	</div>

	<div class="message">
	  
Use `compose()` to rewrite the function below.  
  

	</div>
	<div class="editor" style="height: 20px">// isLastInStock :: [Car] -&gt; Boolean
const isLastInStock = (cars) =&gt; {
  const lastCar = last(cars);
  return prop(&apos;in_stock&apos;, lastCar);
};</div>

	<pre class="hidden code-solution">const isLastInStock = compose(prop(&apos;in_stock&apos;), last);</pre>
	<pre class="hidden code-validation">/* globals isLastInStock */

const fixture01 = cars.slice(0, 3);
const fixture02 = cars.slice(3);

try {
  assert(
    isLastInStock(fixture01),
    &apos;The function gives incorrect results.&apos;,
  );

  assert(
    !isLastInStock(fixture02),
    &apos;The function gives incorrect results.&apos;,
  );
} catch (err) {
  const callees = isLastInStock.callees || [];

  if (callees[0] === &apos;prop&apos; &amp;&amp; callees[1] === &apos;last&apos;) {
    throw new Error(&apos;The answer is incorrect; hint: functions are composed from right to left!&apos;);
  }

  throw err;
}

assert.arrayEqual(
  isLastInStock.callees || [],
  [&apos;last&apos;, &apos;prop&apos;],
  &apos;The answer is incorrect; hint: prop is currified!&apos;,
);</pre>
	
	<pre class="hidden code-context">// NOTE We keep named function here to leverage this in the `compose` function,
// and later on in the validations scripts.

/* eslint-disable prefer-arrow-callback */


/* ---------- Internals ---------- */

function namedAs(value, fn) {
  Object.defineProperty(fn, &apos;name&apos;, { value });
  return fn;
}


// NOTE This file is loaded by gitbook&apos;s exercises plugin. When it does, there&apos;s an
// `assert` function available in the global scope.

/* eslint-disable no-undef, global-require */
if (typeof assert !== &apos;function&apos; &amp;&amp; typeof require === &apos;function&apos;) {
  global.assert = require(&apos;assert&apos;);
}

assert.arrayEqual = function assertArrayEqual(actual, expected, message = &apos;arrayEqual&apos;) {
  if (actual.length !== expected.length) {
    throw new Error(message);
  }

  for (let i = 0; i &lt; expected.length; i += 1) {
    if (expected[i] !== actual[i]) {
      throw new Error(message);
    }
  }
};
/* eslint-enable no-undef, global-require */


function inspect(x) {
  if (x &amp;&amp; typeof x.inspect === &apos;function&apos;) {
    return x.inspect();
  }

  function inspectFn(f) {
    return f.name ? f.name : f.toString();
  }

  function inspectTerm(t) {
    switch (typeof t) {
      case &apos;string&apos;:
        return `&apos;${t}&apos;`;
      case &apos;object&apos;: {
        const ts = Object.keys(t).map(k =&gt; [k, inspect(t[k])]);
        return `{${ts.map(kv =&gt; kv.join(&apos;: &apos;)).join(&apos;, &apos;)}}`;
      }
      default:
        return String(t);
    }
  }

  function inspectArgs(args) {
    return Array.isArray(args) ? `[${args.map(inspect).join(&apos;, &apos;)}]` : inspectTerm(args);
  }

  return (typeof x === &apos;function&apos;) ? inspectFn(x) : inspectArgs(x);
}


/* eslint-disable no-param-reassign */
function withSpyOn(prop, obj, fn) {
  const orig = obj[prop];
  let called = false;
  obj[prop] = function spy(...args) {
    called = true;
    return orig.call(this, ...args);
  };
  fn();
  obj[prop] = orig;
  return called;
}
/* eslint-enable no-param-reassign */


const typeMismatch = (src, got, fn) =&gt; `Type Mismatch in function &apos;${fn}&apos;

        ${fn} :: ${got}

      instead of

        ${fn} :: ${src}`;


const capitalize = s =&gt; `${s[0].toUpperCase()}${s.substring(1)}`;


const ordinal = (i) =&gt; {
  switch (i) {
    case 1:
      return &apos;1st&apos;;
    case 2:
      return &apos;2nd&apos;;
    case 3:
      return &apos;3rd&apos;;
    default:
      return `${i}th`; // NOTE won&apos;t get any much bigger ...
  }
};

const getType = (x) =&gt; {
  if (x === null) {
    return &apos;Null&apos;;
  }

  if (typeof x === &apos;undefined&apos;) {
    return &apos;()&apos;;
  }

  if (Array.isArray(x)) {
    return `[${x[0] ? getType(x[0]) : &apos;?&apos;}]`;
  }

  if (typeof x.getType === &apos;function&apos;) {
    return x.getType();
  }

  if (x.constructor &amp;&amp; x.constructor.name) {
    return x.constructor.name;
  }

  return capitalize(typeof x);
};


/* ---------- Essential FP Functions ---------- */

// NOTE A slightly pumped up version of `curry` which also keeps track of
// whether a function was called partially or with all its arguments at once.
// This is useful to provide insights during validation of exercises.
function curry(fn) {
  assert(
    typeof fn === &apos;function&apos;,
    typeMismatch(&apos;function -&gt; ?&apos;, [getType(fn), &apos;?&apos;].join(&apos; -&gt; &apos;), &apos;curry&apos;),
  );

  const arity = fn.length;

  return namedAs(fn.name, function $curry(...args) {
    $curry.partially = this &amp;&amp; this.partially;

    if (args.length &lt; arity) {
      return namedAs(fn.name, $curry.bind({ partially: true }, ...args));
    }

    return fn.call(this || { partially: false }, ...args);
  });
}


// NOTE A slightly pumped up version of `compose` which also keeps track of the chain
// of callees. In the end, a function created with `compose` holds a `callees` variable
// with the list of all the callees&apos; names.
// This is useful to provide insights during validation of exercises
function compose(...fns) {
  const n = fns.length;

  return function $compose(...args) {
    $compose.callees = [];

    let $args = args;

    for (let i = n - 1; i &gt;= 0; i -= 1) {
      const fn = fns[i];

      assert(
        typeof fn === &apos;function&apos;,
        `Invalid Composition: ${ordinal(n - i)} element in a composition isn&apos;t a function`,
      );

      $compose.callees.push(fn.name);
      $args = [fn.call(null, ...$args)];
    }

    return $args[0];
  };
}


/* ---------- Algebraic Data Structures ---------- */

class Either {
  static of(x) {
    return new Right(x); // eslint-disable-line no-use-before-define
  }

  constructor(x) {
    this.$value = x;
  }
}


class Left extends Either {
  get isLeft() { // eslint-disable-line class-methods-use-this
    return true;
  }

  get isRight() { // eslint-disable-line class-methods-use-this
    return false;
  }

  ap() {
    return this;
  }

  chain() {
    return this;
  }

  inspect() {
    return `Left(${inspect(this.$value)})`;
  }

  getType() {
    return `(Either ${getType(this.$value)} ?)`;
  }

  join() {
    return this;
  }

  map() {
    return this;
  }

  sequence(of) {
    return of(this);
  }

  traverse(of, fn) {
    return of(this);
  }
}


class Right extends Either {
  get isLeft() { // eslint-disable-line class-methods-use-this
    return false;
  }

  get isRight() { // eslint-disable-line class-methods-use-this
    return true;
  }

  ap(f) {
    return f.map(this.$value);
  }

  chain(fn) {
    return fn(this.$value);
  }

  inspect() {
    return `Right(${inspect(this.$value)})`;
  }

  getType() {
    return `(Either ? ${getType(this.$value)})`;
  }

  join() {
    return this.$value;
  }

  map(fn) {
    return Either.of(fn(this.$value));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    fn(this.$value).map(Either.of);
  }
}


class Identity {
  static of(x) {
    return new Identity(x);
  }

  constructor(x) {
    this.$value = x;
  }

  ap(f) {
    return f.map(this.$value);
  }

  chain(fn) {
    return this.map(fn).join();
  }

  inspect() {
    return `Identity(${inspect(this.$value)})`;
  }

  getType() {
    return `(Identity ${getType(this.$value)})`;
  }

  join() {
    return this.$value;
  }

  map(fn) {
    return Identity.of(fn(this.$value));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return fn(this.$value).map(Identity.of);
  }
}

class IO {
  static of(x) {
    return new IO(() =&gt; x);
  }

  constructor(io) {
    assert(
      typeof io === &apos;function&apos;,
      &apos;invalid `io` operation given to IO constructor. Use `IO.of` if you want to lift a value in a default minimal IO context.&apos;,
    );

    this.unsafePerformIO = io;
  }

  ap(f) {
    return this.chain(fn =&gt; f.map(fn));
  }

  chain(fn) {
    return this.map(fn).join();
  }

  inspect() {
    return `IO(${inspect(this.unsafePerformIO())})`;
  }

  getType() {
    return `(IO ${getType(this.unsafePerformIO())})`;
  }


  join() {
    return this.unsafePerformIO();
  }

  map(fn) {
    return new IO(compose(fn, this.unsafePerformIO));
  }
}


class Map {
  constructor(x) {
    assert(
      typeof x === &apos;object&apos; &amp;&amp; x !== null,
      &apos;tried to create `Map` with non object-like&apos;,
    );

    this.$value = x;
  }

  inspect() {
    return `Map(${inspect(this.$value)})`;
  }

  getType() {
    const sample = this.$value[Object.keys(this.$value)[0]];

    return `(Map String ${sample ? getType(sample) : &apos;?&apos;})`;
  }

  insert(k, v) {
    const singleton = {};
    singleton[k] = v;
    return new Map(Object.assign({}, this.$value, singleton));
  }

  reduce(fn, zero) {
    return this.reduceWithKeys((acc, _, k) =&gt; fn(acc, k), zero);
  }

  reduceWithKeys(fn, zero) {
    return Object.keys(this.$value)
      .reduce((acc, k) =&gt; fn(acc, this.$value[k], k), zero);
  }

  map(fn) {
    return new Map(this.reduceWithKeys((obj, v, k) =&gt; {
      obj[k] = fn(v); // eslint-disable-line no-param-reassign
      return obj;
    }, {}));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return this.reduceWithKeys(
      (f, a, k) =&gt; fn(a).map(b =&gt; m =&gt; m.insert(k, b)).ap(f),
      of(new Map({})),
    );
  }
}


class List {
  static of(x) {
    return new List([x]);
  }

  constructor(xs) {
    assert(
      Array.isArray(xs),
      &apos;tried to create `List` from non-array&apos;,
    );

    this.$value = xs;
  }

  concat(x) {
    return new List(this.$value.concat(x));
  }

  inspect() {
    return `List(${inspect(this.$value)})`;
  }

  getType() {
    const sample = this.$value[0];

    return `(List ${sample ? getType(sample) : &apos;?&apos;})`;
  }

  map(fn) {
    return new List(this.$value.map(fn));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return this.$value.reduce(
      (f, a) =&gt; fn(a).map(b =&gt; bs =&gt; bs.concat(b)).ap(f),
      of(new List([])),
    );
  }
}


class Maybe {
  static of(x) {
    return new Maybe(x);
  }

  get isNothing() {
    return this.$value === null || this.$value === undefined;
  }

  get isJust() {
    return !this.isNothing;
  }

  constructor(x) {
    this.$value = x;
  }

  ap(f) {
    return this.isNothing ? this : f.map(this.$value);
  }

  chain(fn) {
    return this.map(fn).join();
  }

  inspect() {
    return this.isNothing ? &apos;Nothing&apos; : `Just(${inspect(this.$value)})`;
  }

  getType() {
    return `(Maybe ${this.isJust ? getType(this.$value) : &apos;?&apos;})`;
  }

  join() {
    return this.isNothing ? this : this.$value;
  }

  map(fn) {
    return this.isNothing ? this : Maybe.of(fn(this.$value));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return this.isNothing ? of(this) : fn(this.$value).map(Maybe.of);
  }
}


class Task {
  constructor(fork) {
    assert(
      typeof fork === &apos;function&apos;,
      &apos;invalid `fork` operation given to Task constructor. Use `Task.of` if you want to lift a value in a default minimal Task context.&apos;,
    );

    this.fork = fork;
  }

  static of(x) {
    return new Task((_, resolve) =&gt; resolve(x));
  }

  static rejected(x) {
    return new Task((reject, _) =&gt; reject(x));
  }

  ap(f) {
    return this.chain(fn =&gt; f.map(fn));
  }

  chain(fn) {
    return new Task((reject, resolve) =&gt; this.fork(reject, x =&gt; fn(x).fork(reject, resolve)));
  }

  inspect() { // eslint-disable-line class-methods-use-this
    return &apos;Task(?)&apos;;
  }

  getType() { // eslint-disable-line class-methods-use-this
    return &apos;(Task ? ?)&apos;;
  }

  join() {
    return this.chain(x =&gt; x);
  }

  map(fn) {
    return new Task((reject, resolve) =&gt; this.fork(reject, compose(resolve, fn)));
  }
}

// In nodejs the existance of a class method named `inspect` will trigger a deprecation warning
// when passing an instance to `console.log`:
// `(node:3845) [DEP0079] DeprecationWarning: Custom inspection function on Objects via .inspect() is deprecated`
// The solution is to alias the existing inspect method with the special inspect symbol exported by node
if (typeof module !== &apos;undefined&apos; &amp;&amp; typeof this !== &apos;undefined&apos; &amp;&amp; this.module !== module) {
  const customInspect = require(&apos;util&apos;).inspect.custom;
  const assignCustomInspect = it =&gt; it.prototype[customInspect] = it.prototype.inspect;
  [Left, Right, Identity, IO, Map, List, Maybe, Task].forEach(assignCustomInspect);
}

const identity = function identity(x) { return x; };

const either = curry(function either(f, g, e) {
  if (e.isLeft) {
    return f(e.$value);
  }

  return g(e.$value);
});

const left = function left(x) { return new Left(x); };

const maybe = curry(function maybe(v, f, m) {
  if (m.isNothing) {
    return v;
  }

  return f(m.$value);
});

const nothing = Maybe.of(null);

const reject = function reject(x) { return Task.rejected(x); };

const chain = curry(function chain(fn, m) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; typeof m.chain === &apos;function&apos;,
    typeMismatch(&apos;Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m a&apos;, [getType(fn), getType(m), &apos;m a&apos;].join(&apos; -&gt; &apos;), &apos;chain&apos;),
  );

  return m.chain(fn);
});

const join = function join(m) {
  assert(
    typeof m.chain === &apos;function&apos;,
    typeMismatch(&apos;Monad m =&gt; m (m a) -&gt; m a&apos;, [getType(m), &apos;m a&apos;].join(&apos; -&gt; &apos;), &apos;join&apos;),
  );

  return m.join();
};

const map = curry(function map(fn, f) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; typeof f.map === &apos;function&apos;,
    typeMismatch(&apos;Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b&apos;, [getType(fn), getType(f), &apos;f b&apos;].join(&apos; -&gt; &apos;), &apos;map&apos;),
  );

  return f.map(fn);
});

const sequence = curry(function sequence(of, x) {
  assert(
    typeof of === &apos;function&apos; &amp;&amp; typeof x.sequence === &apos;function&apos;,
    typeMismatch(&apos;(Applicative f, Traversable t) =&gt; (a -&gt; f a) -&gt; t (f a) -&gt; f (t a)&apos;, [getType(of), getType(x), &apos;f (t a)&apos;].join(&apos; -&gt; &apos;), &apos;sequence&apos;),
  );

  return x.sequence(of);
});

const traverse = curry(function traverse(of, fn, x) {
  assert(
    typeof of === &apos;function&apos; &amp;&amp; typeof fn === &apos;function&apos; &amp;&amp; typeof x.traverse === &apos;function&apos;,
    typeMismatch(
      &apos;(Applicative f, Traversable t) =&gt; (a -&gt; f a) -&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)&apos;,
      [getType(of), getType(fn), getType(x), &apos;f (t b)&apos;].join(&apos; -&gt; &apos;),
      &apos;traverse&apos;,
    ),
  );

  return x.traverse(of, fn);
});

const unsafePerformIO = function unsafePerformIO(io) {
  assert(
    io instanceof IO,
    typeMismatch(&apos;IO a&apos;, getType(io), &apos;unsafePerformIO&apos;),
  );

  return io.unsafePerformIO();
};

const liftA2 = curry(function liftA2(fn, a1, a2) {
  assert(
    typeof fn === &apos;function&apos;
      &amp;&amp; typeof a1.map === &apos;function&apos;
      &amp;&amp; typeof a2.ap === &apos;function&apos;,
    typeMismatch(&apos;Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c&apos;, [getType(fn), getType(a1), getType(a2)].join(&apos; -&gt; &apos;), &apos;liftA2&apos;),
  );

  return a1.map(fn).ap(a2);
});

const liftA3 = curry(function liftA3(fn, a1, a2, a3) {
  assert(
    typeof fn === &apos;function&apos;
      &amp;&amp; typeof a1.map === &apos;function&apos;
      &amp;&amp; typeof a2.ap === &apos;function&apos;
      &amp;&amp; typeof a3.ap === &apos;function&apos;,
    typeMismatch(&apos;Applicative f =&gt; (a -&gt; b -&gt; c -&gt; d) -&gt; f a -&gt; f b -&gt; f c -&gt; f d&apos;, [getType(fn), getType(a1), getType(a2)].join(&apos; -&gt; &apos;), &apos;liftA2&apos;),
  );

  return a1.map(fn).ap(a2).ap(a3);
});

const always = curry(function always(a, b) { return a; });


/* ---------- Pointfree Classic Utilities ---------- */

const append = curry(function append(a, b) {
  assert(
    typeof a === &apos;string&apos; &amp;&amp; typeof b === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String -&gt; String&apos;, [getType(a), getType(b), &apos;String&apos;].join(&apos; -&gt; &apos;), &apos;concat&apos;),
  );

  return b.concat(a);
});

const add = curry(function add(a, b) {
  assert(
    typeof a === &apos;number&apos; &amp;&amp; typeof b === &apos;number&apos;,
    typeMismatch(&apos;Number -&gt; Number -&gt; Number&apos;, [getType(a), getType(b), &apos;Number&apos;].join(&apos; -&gt; &apos;), &apos;add&apos;),
  );

  return a + b;
});

const concat = curry(function concat(a, b) {
  assert(
    typeof a === &apos;string&apos; &amp;&amp; typeof b === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String -&gt; String&apos;, [getType(a), getType(b), &apos;String&apos;].join(&apos; -&gt; &apos;), &apos;concat&apos;),
  );

  return a.concat(b);
});

const eq = curry(function eq(a, b) {
  assert(
    getType(a) === getType(b),
    typeMismatch(&apos;a -&gt; a -&gt; Boolean&apos;, [getType(a), getType(b), &apos;Boolean&apos;].join(&apos; -&gt; &apos;), eq),
  );

  return a === b;
});

const filter = curry(function filter(fn, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;(a -&gt; Boolean) -&gt; [a] -&gt; [a]&apos;, [getType(fn), getType(xs), getType(xs)].join(&apos; -&gt; &apos;), &apos;filter&apos;),
  );

  return xs.filter(fn);
});

const flip = curry(function flip(fn, a, b) {
  assert(
    typeof fn === &apos;function&apos;,
    typeMismatch(&apos;(a -&gt; b) -&gt; (b -&gt; a)&apos;, [getType(fn), &apos;(b -&gt; a)&apos;].join(&apos; -&gt; &apos;), &apos;flip&apos;),
  );

  return fn(b, a);
});

const forEach = curry(function forEach(fn, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;(a -&gt; ()) -&gt; [a] -&gt; ()&apos;, [getType(fn), getType(xs), &apos;()&apos;].join(&apos; -&gt; &apos;), &apos;forEach&apos;),
  );

  xs.forEach(fn);
});

const intercalate = curry(function intercalate(str, xs) {
  assert(
    typeof str === &apos;string&apos; &amp;&amp; Array.isArray(xs) &amp;&amp; (xs.length === 0 || typeof xs[0] === &apos;string&apos;),
    typeMismatch(&apos;String -&gt; [String] -&gt; String&apos;, [getType(str), getType(xs), &apos;String&apos;].join(&apos; -&gt; &apos;), &apos;intercalate&apos;),
  );

  return xs.join(str);
});

const head = function head(xs) {
  assert(
    Array.isArray(xs) || typeof xs === &apos;string&apos;,
    typeMismatch(&apos;[a] -&gt; a&apos;, [getType(xs), &apos;a&apos;].join(&apos; -&gt; &apos;), &apos;head&apos;),
  );

  return xs[0];
};

const last = function last(xs) {
  assert(
    Array.isArray(xs) || typeof xs === &apos;string&apos;,
    typeMismatch(&apos;[a] -&gt; a&apos;, [getType(xs), &apos;a&apos;].join(&apos; -&gt; &apos;), &apos;last&apos;),
  );

  return xs[xs.length - 1];
};

const match = curry(function match(re, str) {
  assert(
    re instanceof RegExp &amp;&amp; typeof str === &apos;string&apos;,
    typeMismatch(&apos;RegExp -&gt; String -&gt; Boolean&apos;, [getType(re), getType(str), &apos;Boolean&apos;].join(&apos; -&gt; &apos;), &apos;match&apos;),
  );

  return re.test(str);
});

const prop = curry(function prop(p, obj) {
  assert(
    typeof p === &apos;string&apos; &amp;&amp; typeof obj === &apos;object&apos; &amp;&amp; obj !== null,
    typeMismatch(&apos;String -&gt; Object -&gt; a&apos;, [getType(p), getType(obj), &apos;a&apos;].join(&apos; -&gt; &apos;), &apos;prop&apos;),
  );

  return obj[p];
});

const reduce = curry(function reduce(fn, zero, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;(b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b&apos;, [getType(fn), getType(zero), getType(xs), &apos;b&apos;].join(&apos; -&gt; &apos;), &apos;reduce&apos;),
  );

  return xs.reduce(
    function $reduceIterator($acc, $x) { return fn($acc, $x); },
    zero,
  );
});

const safeHead = namedAs(&apos;safeHead&apos;, compose(Maybe.of, head));

const safeProp = curry(function safeProp(p, obj) { return Maybe.of(prop(p, obj)); });

const sortBy = curry(function sortBy(fn, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]&apos;, [getType(fn), getType(xs), &apos;[a]&apos;].join(&apos; -&gt; &apos;), &apos;sortBy&apos;),
  );

  return xs.sort((a, b) =&gt; {
    if (fn(a) === fn(b)) {
      return 0;
    }

    return fn(a) &gt; fn(b) ? 1 : -1;
  });
});

const split = curry(function split(s, str) {
  assert(
    typeof s === &apos;string&apos; &amp;&amp; typeof str === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String -&gt; [String]&apos;, [getType(s), getType(str), &apos;[String]&apos;].join(&apos; -&gt; &apos;), &apos;split&apos;),
  );

  return str.split(s);
});

const take = curry(function take(n, xs) {
  assert(
    typeof n === &apos;number&apos; &amp;&amp; (Array.isArray(xs) || typeof xs === &apos;string&apos;),
    typeMismatch(&apos;Number -&gt; [a] -&gt; [a]&apos;, [getType(n), getType(xs), getType(xs)].join(&apos; -&gt; &apos;), &apos;take&apos;),
  );

  return xs.slice(0, n);
});

const toLowerCase = function toLowerCase(s) {
  assert(
    typeof s === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String&apos;, [getType(s), &apos;?&apos;].join(&apos; -&gt; &apos;), &apos;toLowerCase&apos;),
  );

  return s.toLowerCase();
};

const toUpperCase = function toUpperCase(s) {
  assert(
    typeof s === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String&apos;, [getType(s), &apos;?&apos;].join(&apos; -&gt; &apos;), &apos;toLowerCase&apos;),
  );

  return s.toUpperCase();
};


/* ---------- Chapter 4 ---------- */

const keepHighest = function keepHighest(x, y) {
  try {
    keepHighest.calledBy = keepHighest.caller;
  } catch (err) {
    // NOTE node.js runs in strict mode and prohibit the usage of &apos;.caller&apos;
    // There&apos;s a ugly hack to retrieve the caller from stack trace.
    const [, caller] = /at (\S+)/.exec(err.stack.split(&apos;\n&apos;)[2]);

    keepHighest.calledBy = namedAs(caller, () =&gt; {});
  }

  return x &gt;= y ? x : y;
};


/* ---------- Chapter 5 ---------- */

const cars = [{
  name: &apos;Ferrari FF&apos;,
  horsepower: 660,
  dollar_value: 700000,
  in_stock: true,
}, {
  name: &apos;Spyker C12 Zagato&apos;,
  horsepower: 650,
  dollar_value: 648000,
  in_stock: false,
}, {
  name: &apos;Jaguar XKR-S&apos;,
  horsepower: 550,
  dollar_value: 132000,
  in_stock: true,
}, {
  name: &apos;Audi R8&apos;,
  horsepower: 525,
  dollar_value: 114200,
  in_stock: false,
}, {
  name: &apos;Aston Martin One-77&apos;,
  horsepower: 750,
  dollar_value: 1850000,
  in_stock: true,
}, {
  name: &apos;Pagani Huayra&apos;,
  horsepower: 700,
  dollar_value: 1300000,
  in_stock: false,
}];

const average = function average(xs) {
  return xs.reduce(add, 0) / xs.length;
};


/* ---------- Chapter 8 ---------- */

const albert = {
  id: 1,
  active: true,
  name: &apos;Albert&apos;,
  address: {
    street: {
      number: 22,
      name: &apos;Walnut St&apos;,
    },
  },
};

const gary = {
  id: 2,
  active: false,
  name: &apos;Gary&apos;,
  address: {
    street: {
      number: 14,
    },
  },
};

const theresa = {
  id: 3,
  active: true,
  name: &apos;Theresa&apos;,
};

const yi = { id: 4, name: &apos;Yi&apos;, active: true };

const showWelcome = namedAs(&apos;showWelcome&apos;, compose(concat(&apos;Welcome &apos;), prop(&apos;name&apos;)));

const checkActive = function checkActive(user) {
  return user.active
    ? Either.of(user)
    : left(&apos;Your account is not active&apos;);
};

const save = function save(user) {
  return new IO(() =&gt; Object.assign({}, user, { saved: true }));
};

const validateUser = curry(function validateUser(validate, user) {
  return validate(user).map(_ =&gt; user); // eslint-disable-line no-unused-vars
});


/* ---------- Chapter 9 ---------- */

const getFile = IO.of(&apos;/home/mostly-adequate/ch09.md&apos;);

const pureLog = function pureLog(str) { return new IO(() =&gt; { console.log(str); return str; }); };

const addToMailingList = function addToMailingList(email) { return IO.of([email]); };

const emailBlast = function emailBlast(list) { return IO.of(list.join(&apos;,&apos;)); };

const validateEmail = function validateEmail(x) {
  return /\S+@\S+\.\S+/.test(x)
    ? Either.of(x)
    : left(&apos;invalid email&apos;);
};


/* ---------- Chapter 10 ---------- */

const localStorage = { player1: albert, player2: theresa };

const game = curry(function game(p1, p2) { return `${p1.name} vs ${p2.name}`; });

const getFromCache = function getFromCache(x) { return new IO(() =&gt; localStorage[x]); };


/* ---------- Chapter 11 ---------- */

const findUserById = function findUserById(id) {
  switch (id) {
    case 1:
      return Task.of(Either.of(albert));

    case 2:
      return Task.of(Either.of(gary));

    case 3:
      return Task.of(Either.of(theresa));

    default:
      return Task.of(left(&apos;not found&apos;));
  }
};

const eitherToTask = namedAs(&apos;eitherToTask&apos;, either(Task.rejected, Task.of));


/* ---------- Chapter 12 ---------- */

const httpGet = function httpGet(route) { return Task.of(`json for ${route}`); };

const routes = new Map({
  &apos;/&apos;: &apos;/&apos;,
  &apos;/about&apos;: &apos;/about&apos;,
});

const validate = function validate(player) {
  return player.name
    ? Either.of(player)
    : left(&apos;must have name&apos;);
};

const readdir = function readdir(dir) {
  return Task.of([&apos;file1&apos;, &apos;file2&apos;, &apos;file3&apos;]);
};

const readfile = curry(function readfile(encoding, file) {
  return Task.of(`content of ${file} (${encoding})`);
});


/* ---------- Exports ---------- */

if (typeof module === &apos;object&apos;) {
  module.exports = {
    // Utils
    withSpyOn,

    // Essential FP helpers
    always,
    compose,
    curry,
    either,
    identity,
    inspect,
    left,
    liftA2,
    liftA3,
    maybe,
    nothing,
    reject,

    // Algebraic Data Structures
    Either,
    IO,
    Identity,
    Left,
    List,
    Map,
    Maybe,
    Right,
    Task,

    // Currified version of &apos;standard&apos; functions
    append,
    add,
    chain,
    concat,
    eq,
    filter,
    flip,
    forEach,
    head,
    intercalate,
    join,
    last,
    map,
    match,
    prop,
    reduce,
    safeHead,
    safeProp,
    sequence,
    sortBy,
    split,
    take,
    toLowerCase,
    toUpperCase,
    traverse,
    unsafePerformIO,

    // Chapter 04
    keepHighest,

    // Chapter 05
    cars,
    average,

    // Chapter 08
    albert,
    gary,
    theresa,
    yi,
    showWelcome,
    checkActive,
    save,
    validateUser,

    // Chapter 09
    getFile,
    pureLog,
    addToMailingList,
    emailBlast,
    validateEmail,

    // Chapter 10
    localStorage,
    getFromCache,
    game,

    // Chapter 11
    findUserById,
    eitherToTask,

    // Chapter 12
    httpGet,
    routes,
    validate,
    readdir,
    readfile,
  };
}</pre>
	

	<div class="buttons">
	    <a href="#" class="button size-2 action-submit">Submit</a>
	    <a href="#" class="button size-2 action-solution">Solution</a>
	</div>
</div>  </p>
<hr>
<p>Considering the following function:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> average = xs =&gt; reduce(add, <span class="hljs-number">0</span>, xs) / xs.length;
</code></pre>
<p><div class="exercise">
	<div class="header">Exercise</div>
	<div class="alert alert-success">
	    <b>Correct!</b>
	</div>

	<div class="alert alert-danger error-message">
	    <b>False!</b>
	</div>

	<div class="message">
	  
Use the helper function `average` to refactor `averageDollarValue` as a composition.  
  

	</div>
	<div class="editor" style="height: 20px">// averageDollarValue :: [Car] -&gt; Int
const averageDollarValue = (cars) =&gt; {
  const dollarValues = map(c =&gt; c.dollar_value, cars);
  return average(dollarValues);
};</div>

	<pre class="hidden code-solution">const averageDollarValue = compose(average, map(prop(&apos;dollar_value&apos;)));</pre>
	<pre class="hidden code-validation">/* globals averageDollarValue */

try {
  assert(
    averageDollarValue(cars) === 790700,
    &apos;The function gives incorrect results.&apos;,
  );
} catch (err) {
  const callees = averageDollarValue.callees || [];

  if (callees[0] === &apos;average&apos; &amp;&amp; callees[1] === &apos;map&apos;) {
    throw new Error(&apos;The answer is incorrect; hint: functions are composed from right to left!&apos;);
  }

  throw err;
}

assert.arrayEqual(
  averageDollarValue.callees || [],
  [&apos;map&apos;, &apos;average&apos;],
  &apos;The answer is incorrect; hint: map is currified!&apos;,
);

assert(
  prop.partially,
  &apos;The answer is almost correct; hint: you can use prop to access objects\&apos; properties!&apos;,
);</pre>
	
	<pre class="hidden code-context">// NOTE We keep named function here to leverage this in the `compose` function,
// and later on in the validations scripts.

/* eslint-disable prefer-arrow-callback */


/* ---------- Internals ---------- */

function namedAs(value, fn) {
  Object.defineProperty(fn, &apos;name&apos;, { value });
  return fn;
}


// NOTE This file is loaded by gitbook&apos;s exercises plugin. When it does, there&apos;s an
// `assert` function available in the global scope.

/* eslint-disable no-undef, global-require */
if (typeof assert !== &apos;function&apos; &amp;&amp; typeof require === &apos;function&apos;) {
  global.assert = require(&apos;assert&apos;);
}

assert.arrayEqual = function assertArrayEqual(actual, expected, message = &apos;arrayEqual&apos;) {
  if (actual.length !== expected.length) {
    throw new Error(message);
  }

  for (let i = 0; i &lt; expected.length; i += 1) {
    if (expected[i] !== actual[i]) {
      throw new Error(message);
    }
  }
};
/* eslint-enable no-undef, global-require */


function inspect(x) {
  if (x &amp;&amp; typeof x.inspect === &apos;function&apos;) {
    return x.inspect();
  }

  function inspectFn(f) {
    return f.name ? f.name : f.toString();
  }

  function inspectTerm(t) {
    switch (typeof t) {
      case &apos;string&apos;:
        return `&apos;${t}&apos;`;
      case &apos;object&apos;: {
        const ts = Object.keys(t).map(k =&gt; [k, inspect(t[k])]);
        return `{${ts.map(kv =&gt; kv.join(&apos;: &apos;)).join(&apos;, &apos;)}}`;
      }
      default:
        return String(t);
    }
  }

  function inspectArgs(args) {
    return Array.isArray(args) ? `[${args.map(inspect).join(&apos;, &apos;)}]` : inspectTerm(args);
  }

  return (typeof x === &apos;function&apos;) ? inspectFn(x) : inspectArgs(x);
}


/* eslint-disable no-param-reassign */
function withSpyOn(prop, obj, fn) {
  const orig = obj[prop];
  let called = false;
  obj[prop] = function spy(...args) {
    called = true;
    return orig.call(this, ...args);
  };
  fn();
  obj[prop] = orig;
  return called;
}
/* eslint-enable no-param-reassign */


const typeMismatch = (src, got, fn) =&gt; `Type Mismatch in function &apos;${fn}&apos;

        ${fn} :: ${got}

      instead of

        ${fn} :: ${src}`;


const capitalize = s =&gt; `${s[0].toUpperCase()}${s.substring(1)}`;


const ordinal = (i) =&gt; {
  switch (i) {
    case 1:
      return &apos;1st&apos;;
    case 2:
      return &apos;2nd&apos;;
    case 3:
      return &apos;3rd&apos;;
    default:
      return `${i}th`; // NOTE won&apos;t get any much bigger ...
  }
};

const getType = (x) =&gt; {
  if (x === null) {
    return &apos;Null&apos;;
  }

  if (typeof x === &apos;undefined&apos;) {
    return &apos;()&apos;;
  }

  if (Array.isArray(x)) {
    return `[${x[0] ? getType(x[0]) : &apos;?&apos;}]`;
  }

  if (typeof x.getType === &apos;function&apos;) {
    return x.getType();
  }

  if (x.constructor &amp;&amp; x.constructor.name) {
    return x.constructor.name;
  }

  return capitalize(typeof x);
};


/* ---------- Essential FP Functions ---------- */

// NOTE A slightly pumped up version of `curry` which also keeps track of
// whether a function was called partially or with all its arguments at once.
// This is useful to provide insights during validation of exercises.
function curry(fn) {
  assert(
    typeof fn === &apos;function&apos;,
    typeMismatch(&apos;function -&gt; ?&apos;, [getType(fn), &apos;?&apos;].join(&apos; -&gt; &apos;), &apos;curry&apos;),
  );

  const arity = fn.length;

  return namedAs(fn.name, function $curry(...args) {
    $curry.partially = this &amp;&amp; this.partially;

    if (args.length &lt; arity) {
      return namedAs(fn.name, $curry.bind({ partially: true }, ...args));
    }

    return fn.call(this || { partially: false }, ...args);
  });
}


// NOTE A slightly pumped up version of `compose` which also keeps track of the chain
// of callees. In the end, a function created with `compose` holds a `callees` variable
// with the list of all the callees&apos; names.
// This is useful to provide insights during validation of exercises
function compose(...fns) {
  const n = fns.length;

  return function $compose(...args) {
    $compose.callees = [];

    let $args = args;

    for (let i = n - 1; i &gt;= 0; i -= 1) {
      const fn = fns[i];

      assert(
        typeof fn === &apos;function&apos;,
        `Invalid Composition: ${ordinal(n - i)} element in a composition isn&apos;t a function`,
      );

      $compose.callees.push(fn.name);
      $args = [fn.call(null, ...$args)];
    }

    return $args[0];
  };
}


/* ---------- Algebraic Data Structures ---------- */

class Either {
  static of(x) {
    return new Right(x); // eslint-disable-line no-use-before-define
  }

  constructor(x) {
    this.$value = x;
  }
}


class Left extends Either {
  get isLeft() { // eslint-disable-line class-methods-use-this
    return true;
  }

  get isRight() { // eslint-disable-line class-methods-use-this
    return false;
  }

  ap() {
    return this;
  }

  chain() {
    return this;
  }

  inspect() {
    return `Left(${inspect(this.$value)})`;
  }

  getType() {
    return `(Either ${getType(this.$value)} ?)`;
  }

  join() {
    return this;
  }

  map() {
    return this;
  }

  sequence(of) {
    return of(this);
  }

  traverse(of, fn) {
    return of(this);
  }
}


class Right extends Either {
  get isLeft() { // eslint-disable-line class-methods-use-this
    return false;
  }

  get isRight() { // eslint-disable-line class-methods-use-this
    return true;
  }

  ap(f) {
    return f.map(this.$value);
  }

  chain(fn) {
    return fn(this.$value);
  }

  inspect() {
    return `Right(${inspect(this.$value)})`;
  }

  getType() {
    return `(Either ? ${getType(this.$value)})`;
  }

  join() {
    return this.$value;
  }

  map(fn) {
    return Either.of(fn(this.$value));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    fn(this.$value).map(Either.of);
  }
}


class Identity {
  static of(x) {
    return new Identity(x);
  }

  constructor(x) {
    this.$value = x;
  }

  ap(f) {
    return f.map(this.$value);
  }

  chain(fn) {
    return this.map(fn).join();
  }

  inspect() {
    return `Identity(${inspect(this.$value)})`;
  }

  getType() {
    return `(Identity ${getType(this.$value)})`;
  }

  join() {
    return this.$value;
  }

  map(fn) {
    return Identity.of(fn(this.$value));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return fn(this.$value).map(Identity.of);
  }
}

class IO {
  static of(x) {
    return new IO(() =&gt; x);
  }

  constructor(io) {
    assert(
      typeof io === &apos;function&apos;,
      &apos;invalid `io` operation given to IO constructor. Use `IO.of` if you want to lift a value in a default minimal IO context.&apos;,
    );

    this.unsafePerformIO = io;
  }

  ap(f) {
    return this.chain(fn =&gt; f.map(fn));
  }

  chain(fn) {
    return this.map(fn).join();
  }

  inspect() {
    return `IO(${inspect(this.unsafePerformIO())})`;
  }

  getType() {
    return `(IO ${getType(this.unsafePerformIO())})`;
  }


  join() {
    return this.unsafePerformIO();
  }

  map(fn) {
    return new IO(compose(fn, this.unsafePerformIO));
  }
}


class Map {
  constructor(x) {
    assert(
      typeof x === &apos;object&apos; &amp;&amp; x !== null,
      &apos;tried to create `Map` with non object-like&apos;,
    );

    this.$value = x;
  }

  inspect() {
    return `Map(${inspect(this.$value)})`;
  }

  getType() {
    const sample = this.$value[Object.keys(this.$value)[0]];

    return `(Map String ${sample ? getType(sample) : &apos;?&apos;})`;
  }

  insert(k, v) {
    const singleton = {};
    singleton[k] = v;
    return new Map(Object.assign({}, this.$value, singleton));
  }

  reduce(fn, zero) {
    return this.reduceWithKeys((acc, _, k) =&gt; fn(acc, k), zero);
  }

  reduceWithKeys(fn, zero) {
    return Object.keys(this.$value)
      .reduce((acc, k) =&gt; fn(acc, this.$value[k], k), zero);
  }

  map(fn) {
    return new Map(this.reduceWithKeys((obj, v, k) =&gt; {
      obj[k] = fn(v); // eslint-disable-line no-param-reassign
      return obj;
    }, {}));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return this.reduceWithKeys(
      (f, a, k) =&gt; fn(a).map(b =&gt; m =&gt; m.insert(k, b)).ap(f),
      of(new Map({})),
    );
  }
}


class List {
  static of(x) {
    return new List([x]);
  }

  constructor(xs) {
    assert(
      Array.isArray(xs),
      &apos;tried to create `List` from non-array&apos;,
    );

    this.$value = xs;
  }

  concat(x) {
    return new List(this.$value.concat(x));
  }

  inspect() {
    return `List(${inspect(this.$value)})`;
  }

  getType() {
    const sample = this.$value[0];

    return `(List ${sample ? getType(sample) : &apos;?&apos;})`;
  }

  map(fn) {
    return new List(this.$value.map(fn));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return this.$value.reduce(
      (f, a) =&gt; fn(a).map(b =&gt; bs =&gt; bs.concat(b)).ap(f),
      of(new List([])),
    );
  }
}


class Maybe {
  static of(x) {
    return new Maybe(x);
  }

  get isNothing() {
    return this.$value === null || this.$value === undefined;
  }

  get isJust() {
    return !this.isNothing;
  }

  constructor(x) {
    this.$value = x;
  }

  ap(f) {
    return this.isNothing ? this : f.map(this.$value);
  }

  chain(fn) {
    return this.map(fn).join();
  }

  inspect() {
    return this.isNothing ? &apos;Nothing&apos; : `Just(${inspect(this.$value)})`;
  }

  getType() {
    return `(Maybe ${this.isJust ? getType(this.$value) : &apos;?&apos;})`;
  }

  join() {
    return this.isNothing ? this : this.$value;
  }

  map(fn) {
    return this.isNothing ? this : Maybe.of(fn(this.$value));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return this.isNothing ? of(this) : fn(this.$value).map(Maybe.of);
  }
}


class Task {
  constructor(fork) {
    assert(
      typeof fork === &apos;function&apos;,
      &apos;invalid `fork` operation given to Task constructor. Use `Task.of` if you want to lift a value in a default minimal Task context.&apos;,
    );

    this.fork = fork;
  }

  static of(x) {
    return new Task((_, resolve) =&gt; resolve(x));
  }

  static rejected(x) {
    return new Task((reject, _) =&gt; reject(x));
  }

  ap(f) {
    return this.chain(fn =&gt; f.map(fn));
  }

  chain(fn) {
    return new Task((reject, resolve) =&gt; this.fork(reject, x =&gt; fn(x).fork(reject, resolve)));
  }

  inspect() { // eslint-disable-line class-methods-use-this
    return &apos;Task(?)&apos;;
  }

  getType() { // eslint-disable-line class-methods-use-this
    return &apos;(Task ? ?)&apos;;
  }

  join() {
    return this.chain(x =&gt; x);
  }

  map(fn) {
    return new Task((reject, resolve) =&gt; this.fork(reject, compose(resolve, fn)));
  }
}

// In nodejs the existance of a class method named `inspect` will trigger a deprecation warning
// when passing an instance to `console.log`:
// `(node:3845) [DEP0079] DeprecationWarning: Custom inspection function on Objects via .inspect() is deprecated`
// The solution is to alias the existing inspect method with the special inspect symbol exported by node
if (typeof module !== &apos;undefined&apos; &amp;&amp; typeof this !== &apos;undefined&apos; &amp;&amp; this.module !== module) {
  const customInspect = require(&apos;util&apos;).inspect.custom;
  const assignCustomInspect = it =&gt; it.prototype[customInspect] = it.prototype.inspect;
  [Left, Right, Identity, IO, Map, List, Maybe, Task].forEach(assignCustomInspect);
}

const identity = function identity(x) { return x; };

const either = curry(function either(f, g, e) {
  if (e.isLeft) {
    return f(e.$value);
  }

  return g(e.$value);
});

const left = function left(x) { return new Left(x); };

const maybe = curry(function maybe(v, f, m) {
  if (m.isNothing) {
    return v;
  }

  return f(m.$value);
});

const nothing = Maybe.of(null);

const reject = function reject(x) { return Task.rejected(x); };

const chain = curry(function chain(fn, m) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; typeof m.chain === &apos;function&apos;,
    typeMismatch(&apos;Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m a&apos;, [getType(fn), getType(m), &apos;m a&apos;].join(&apos; -&gt; &apos;), &apos;chain&apos;),
  );

  return m.chain(fn);
});

const join = function join(m) {
  assert(
    typeof m.chain === &apos;function&apos;,
    typeMismatch(&apos;Monad m =&gt; m (m a) -&gt; m a&apos;, [getType(m), &apos;m a&apos;].join(&apos; -&gt; &apos;), &apos;join&apos;),
  );

  return m.join();
};

const map = curry(function map(fn, f) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; typeof f.map === &apos;function&apos;,
    typeMismatch(&apos;Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b&apos;, [getType(fn), getType(f), &apos;f b&apos;].join(&apos; -&gt; &apos;), &apos;map&apos;),
  );

  return f.map(fn);
});

const sequence = curry(function sequence(of, x) {
  assert(
    typeof of === &apos;function&apos; &amp;&amp; typeof x.sequence === &apos;function&apos;,
    typeMismatch(&apos;(Applicative f, Traversable t) =&gt; (a -&gt; f a) -&gt; t (f a) -&gt; f (t a)&apos;, [getType(of), getType(x), &apos;f (t a)&apos;].join(&apos; -&gt; &apos;), &apos;sequence&apos;),
  );

  return x.sequence(of);
});

const traverse = curry(function traverse(of, fn, x) {
  assert(
    typeof of === &apos;function&apos; &amp;&amp; typeof fn === &apos;function&apos; &amp;&amp; typeof x.traverse === &apos;function&apos;,
    typeMismatch(
      &apos;(Applicative f, Traversable t) =&gt; (a -&gt; f a) -&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)&apos;,
      [getType(of), getType(fn), getType(x), &apos;f (t b)&apos;].join(&apos; -&gt; &apos;),
      &apos;traverse&apos;,
    ),
  );

  return x.traverse(of, fn);
});

const unsafePerformIO = function unsafePerformIO(io) {
  assert(
    io instanceof IO,
    typeMismatch(&apos;IO a&apos;, getType(io), &apos;unsafePerformIO&apos;),
  );

  return io.unsafePerformIO();
};

const liftA2 = curry(function liftA2(fn, a1, a2) {
  assert(
    typeof fn === &apos;function&apos;
      &amp;&amp; typeof a1.map === &apos;function&apos;
      &amp;&amp; typeof a2.ap === &apos;function&apos;,
    typeMismatch(&apos;Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c&apos;, [getType(fn), getType(a1), getType(a2)].join(&apos; -&gt; &apos;), &apos;liftA2&apos;),
  );

  return a1.map(fn).ap(a2);
});

const liftA3 = curry(function liftA3(fn, a1, a2, a3) {
  assert(
    typeof fn === &apos;function&apos;
      &amp;&amp; typeof a1.map === &apos;function&apos;
      &amp;&amp; typeof a2.ap === &apos;function&apos;
      &amp;&amp; typeof a3.ap === &apos;function&apos;,
    typeMismatch(&apos;Applicative f =&gt; (a -&gt; b -&gt; c -&gt; d) -&gt; f a -&gt; f b -&gt; f c -&gt; f d&apos;, [getType(fn), getType(a1), getType(a2)].join(&apos; -&gt; &apos;), &apos;liftA2&apos;),
  );

  return a1.map(fn).ap(a2).ap(a3);
});

const always = curry(function always(a, b) { return a; });


/* ---------- Pointfree Classic Utilities ---------- */

const append = curry(function append(a, b) {
  assert(
    typeof a === &apos;string&apos; &amp;&amp; typeof b === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String -&gt; String&apos;, [getType(a), getType(b), &apos;String&apos;].join(&apos; -&gt; &apos;), &apos;concat&apos;),
  );

  return b.concat(a);
});

const add = curry(function add(a, b) {
  assert(
    typeof a === &apos;number&apos; &amp;&amp; typeof b === &apos;number&apos;,
    typeMismatch(&apos;Number -&gt; Number -&gt; Number&apos;, [getType(a), getType(b), &apos;Number&apos;].join(&apos; -&gt; &apos;), &apos;add&apos;),
  );

  return a + b;
});

const concat = curry(function concat(a, b) {
  assert(
    typeof a === &apos;string&apos; &amp;&amp; typeof b === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String -&gt; String&apos;, [getType(a), getType(b), &apos;String&apos;].join(&apos; -&gt; &apos;), &apos;concat&apos;),
  );

  return a.concat(b);
});

const eq = curry(function eq(a, b) {
  assert(
    getType(a) === getType(b),
    typeMismatch(&apos;a -&gt; a -&gt; Boolean&apos;, [getType(a), getType(b), &apos;Boolean&apos;].join(&apos; -&gt; &apos;), eq),
  );

  return a === b;
});

const filter = curry(function filter(fn, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;(a -&gt; Boolean) -&gt; [a] -&gt; [a]&apos;, [getType(fn), getType(xs), getType(xs)].join(&apos; -&gt; &apos;), &apos;filter&apos;),
  );

  return xs.filter(fn);
});

const flip = curry(function flip(fn, a, b) {
  assert(
    typeof fn === &apos;function&apos;,
    typeMismatch(&apos;(a -&gt; b) -&gt; (b -&gt; a)&apos;, [getType(fn), &apos;(b -&gt; a)&apos;].join(&apos; -&gt; &apos;), &apos;flip&apos;),
  );

  return fn(b, a);
});

const forEach = curry(function forEach(fn, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;(a -&gt; ()) -&gt; [a] -&gt; ()&apos;, [getType(fn), getType(xs), &apos;()&apos;].join(&apos; -&gt; &apos;), &apos;forEach&apos;),
  );

  xs.forEach(fn);
});

const intercalate = curry(function intercalate(str, xs) {
  assert(
    typeof str === &apos;string&apos; &amp;&amp; Array.isArray(xs) &amp;&amp; (xs.length === 0 || typeof xs[0] === &apos;string&apos;),
    typeMismatch(&apos;String -&gt; [String] -&gt; String&apos;, [getType(str), getType(xs), &apos;String&apos;].join(&apos; -&gt; &apos;), &apos;intercalate&apos;),
  );

  return xs.join(str);
});

const head = function head(xs) {
  assert(
    Array.isArray(xs) || typeof xs === &apos;string&apos;,
    typeMismatch(&apos;[a] -&gt; a&apos;, [getType(xs), &apos;a&apos;].join(&apos; -&gt; &apos;), &apos;head&apos;),
  );

  return xs[0];
};

const last = function last(xs) {
  assert(
    Array.isArray(xs) || typeof xs === &apos;string&apos;,
    typeMismatch(&apos;[a] -&gt; a&apos;, [getType(xs), &apos;a&apos;].join(&apos; -&gt; &apos;), &apos;last&apos;),
  );

  return xs[xs.length - 1];
};

const match = curry(function match(re, str) {
  assert(
    re instanceof RegExp &amp;&amp; typeof str === &apos;string&apos;,
    typeMismatch(&apos;RegExp -&gt; String -&gt; Boolean&apos;, [getType(re), getType(str), &apos;Boolean&apos;].join(&apos; -&gt; &apos;), &apos;match&apos;),
  );

  return re.test(str);
});

const prop = curry(function prop(p, obj) {
  assert(
    typeof p === &apos;string&apos; &amp;&amp; typeof obj === &apos;object&apos; &amp;&amp; obj !== null,
    typeMismatch(&apos;String -&gt; Object -&gt; a&apos;, [getType(p), getType(obj), &apos;a&apos;].join(&apos; -&gt; &apos;), &apos;prop&apos;),
  );

  return obj[p];
});

const reduce = curry(function reduce(fn, zero, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;(b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b&apos;, [getType(fn), getType(zero), getType(xs), &apos;b&apos;].join(&apos; -&gt; &apos;), &apos;reduce&apos;),
  );

  return xs.reduce(
    function $reduceIterator($acc, $x) { return fn($acc, $x); },
    zero,
  );
});

const safeHead = namedAs(&apos;safeHead&apos;, compose(Maybe.of, head));

const safeProp = curry(function safeProp(p, obj) { return Maybe.of(prop(p, obj)); });

const sortBy = curry(function sortBy(fn, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]&apos;, [getType(fn), getType(xs), &apos;[a]&apos;].join(&apos; -&gt; &apos;), &apos;sortBy&apos;),
  );

  return xs.sort((a, b) =&gt; {
    if (fn(a) === fn(b)) {
      return 0;
    }

    return fn(a) &gt; fn(b) ? 1 : -1;
  });
});

const split = curry(function split(s, str) {
  assert(
    typeof s === &apos;string&apos; &amp;&amp; typeof str === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String -&gt; [String]&apos;, [getType(s), getType(str), &apos;[String]&apos;].join(&apos; -&gt; &apos;), &apos;split&apos;),
  );

  return str.split(s);
});

const take = curry(function take(n, xs) {
  assert(
    typeof n === &apos;number&apos; &amp;&amp; (Array.isArray(xs) || typeof xs === &apos;string&apos;),
    typeMismatch(&apos;Number -&gt; [a] -&gt; [a]&apos;, [getType(n), getType(xs), getType(xs)].join(&apos; -&gt; &apos;), &apos;take&apos;),
  );

  return xs.slice(0, n);
});

const toLowerCase = function toLowerCase(s) {
  assert(
    typeof s === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String&apos;, [getType(s), &apos;?&apos;].join(&apos; -&gt; &apos;), &apos;toLowerCase&apos;),
  );

  return s.toLowerCase();
};

const toUpperCase = function toUpperCase(s) {
  assert(
    typeof s === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String&apos;, [getType(s), &apos;?&apos;].join(&apos; -&gt; &apos;), &apos;toLowerCase&apos;),
  );

  return s.toUpperCase();
};


/* ---------- Chapter 4 ---------- */

const keepHighest = function keepHighest(x, y) {
  try {
    keepHighest.calledBy = keepHighest.caller;
  } catch (err) {
    // NOTE node.js runs in strict mode and prohibit the usage of &apos;.caller&apos;
    // There&apos;s a ugly hack to retrieve the caller from stack trace.
    const [, caller] = /at (\S+)/.exec(err.stack.split(&apos;\n&apos;)[2]);

    keepHighest.calledBy = namedAs(caller, () =&gt; {});
  }

  return x &gt;= y ? x : y;
};


/* ---------- Chapter 5 ---------- */

const cars = [{
  name: &apos;Ferrari FF&apos;,
  horsepower: 660,
  dollar_value: 700000,
  in_stock: true,
}, {
  name: &apos;Spyker C12 Zagato&apos;,
  horsepower: 650,
  dollar_value: 648000,
  in_stock: false,
}, {
  name: &apos;Jaguar XKR-S&apos;,
  horsepower: 550,
  dollar_value: 132000,
  in_stock: true,
}, {
  name: &apos;Audi R8&apos;,
  horsepower: 525,
  dollar_value: 114200,
  in_stock: false,
}, {
  name: &apos;Aston Martin One-77&apos;,
  horsepower: 750,
  dollar_value: 1850000,
  in_stock: true,
}, {
  name: &apos;Pagani Huayra&apos;,
  horsepower: 700,
  dollar_value: 1300000,
  in_stock: false,
}];

const average = function average(xs) {
  return xs.reduce(add, 0) / xs.length;
};


/* ---------- Chapter 8 ---------- */

const albert = {
  id: 1,
  active: true,
  name: &apos;Albert&apos;,
  address: {
    street: {
      number: 22,
      name: &apos;Walnut St&apos;,
    },
  },
};

const gary = {
  id: 2,
  active: false,
  name: &apos;Gary&apos;,
  address: {
    street: {
      number: 14,
    },
  },
};

const theresa = {
  id: 3,
  active: true,
  name: &apos;Theresa&apos;,
};

const yi = { id: 4, name: &apos;Yi&apos;, active: true };

const showWelcome = namedAs(&apos;showWelcome&apos;, compose(concat(&apos;Welcome &apos;), prop(&apos;name&apos;)));

const checkActive = function checkActive(user) {
  return user.active
    ? Either.of(user)
    : left(&apos;Your account is not active&apos;);
};

const save = function save(user) {
  return new IO(() =&gt; Object.assign({}, user, { saved: true }));
};

const validateUser = curry(function validateUser(validate, user) {
  return validate(user).map(_ =&gt; user); // eslint-disable-line no-unused-vars
});


/* ---------- Chapter 9 ---------- */

const getFile = IO.of(&apos;/home/mostly-adequate/ch09.md&apos;);

const pureLog = function pureLog(str) { return new IO(() =&gt; { console.log(str); return str; }); };

const addToMailingList = function addToMailingList(email) { return IO.of([email]); };

const emailBlast = function emailBlast(list) { return IO.of(list.join(&apos;,&apos;)); };

const validateEmail = function validateEmail(x) {
  return /\S+@\S+\.\S+/.test(x)
    ? Either.of(x)
    : left(&apos;invalid email&apos;);
};


/* ---------- Chapter 10 ---------- */

const localStorage = { player1: albert, player2: theresa };

const game = curry(function game(p1, p2) { return `${p1.name} vs ${p2.name}`; });

const getFromCache = function getFromCache(x) { return new IO(() =&gt; localStorage[x]); };


/* ---------- Chapter 11 ---------- */

const findUserById = function findUserById(id) {
  switch (id) {
    case 1:
      return Task.of(Either.of(albert));

    case 2:
      return Task.of(Either.of(gary));

    case 3:
      return Task.of(Either.of(theresa));

    default:
      return Task.of(left(&apos;not found&apos;));
  }
};

const eitherToTask = namedAs(&apos;eitherToTask&apos;, either(Task.rejected, Task.of));


/* ---------- Chapter 12 ---------- */

const httpGet = function httpGet(route) { return Task.of(`json for ${route}`); };

const routes = new Map({
  &apos;/&apos;: &apos;/&apos;,
  &apos;/about&apos;: &apos;/about&apos;,
});

const validate = function validate(player) {
  return player.name
    ? Either.of(player)
    : left(&apos;must have name&apos;);
};

const readdir = function readdir(dir) {
  return Task.of([&apos;file1&apos;, &apos;file2&apos;, &apos;file3&apos;]);
};

const readfile = curry(function readfile(encoding, file) {
  return Task.of(`content of ${file} (${encoding})`);
});


/* ---------- Exports ---------- */

if (typeof module === &apos;object&apos;) {
  module.exports = {
    // Utils
    withSpyOn,

    // Essential FP helpers
    always,
    compose,
    curry,
    either,
    identity,
    inspect,
    left,
    liftA2,
    liftA3,
    maybe,
    nothing,
    reject,

    // Algebraic Data Structures
    Either,
    IO,
    Identity,
    Left,
    List,
    Map,
    Maybe,
    Right,
    Task,

    // Currified version of &apos;standard&apos; functions
    append,
    add,
    chain,
    concat,
    eq,
    filter,
    flip,
    forEach,
    head,
    intercalate,
    join,
    last,
    map,
    match,
    prop,
    reduce,
    safeHead,
    safeProp,
    sequence,
    sortBy,
    split,
    take,
    toLowerCase,
    toUpperCase,
    traverse,
    unsafePerformIO,

    // Chapter 04
    keepHighest,

    // Chapter 05
    cars,
    average,

    // Chapter 08
    albert,
    gary,
    theresa,
    yi,
    showWelcome,
    checkActive,
    save,
    validateUser,

    // Chapter 09
    getFile,
    pureLog,
    addToMailingList,
    emailBlast,
    validateEmail,

    // Chapter 10
    localStorage,
    getFromCache,
    game,

    // Chapter 11
    findUserById,
    eitherToTask,

    // Chapter 12
    httpGet,
    routes,
    validate,
    readdir,
    readfile,
  };
}</pre>
	

	<div class="buttons">
	    <a href="#" class="button size-2 action-submit">Submit</a>
	    <a href="#" class="button size-2 action-solution">Solution</a>
	</div>
</div>  </p>
<hr>
<p><div class="exercise">
	<div class="header">Exercise</div>
	<div class="alert alert-success">
	    <b>Correct!</b>
	</div>

	<div class="alert alert-danger error-message">
	    <b>False!</b>
	</div>

	<div class="message">
	  
Refactor `fastestCar` using `compose()` and other functions in pointfree-style. Hint, the  
`append` function may come in handy.  
  

	</div>
	<div class="editor" style="height: 120px">const fastestCar = (cars) =&gt; {
  const sorted = sortBy(car =&gt; car.horsepower, cars);
  const fastest = last(sorted);
  return concat(fastest.name, &apos; is the fastest&apos;);
};</div>

	<pre class="hidden code-solution">const fastestCar = compose(
  append(&apos; is the fastest&apos;),
  prop(&apos;name&apos;),
  last,
  sortBy(prop(&apos;horsepower&apos;)),
);</pre>
	<pre class="hidden code-validation">/* globals fastestCar */

try {
  assert(
    fastestCar(cars) === &apos;Aston Martin One-77 is the fastest&apos;,
    &apos;The function gives incorrect results.&apos;,
  );
} catch (err) {
  const callees = fastestCar.callees || [];

  if (callees.length &gt; 0 &amp;&amp; callees[0] !== &apos;sortBy&apos;) {
    throw new Error(&apos;The answer is incorrect; hint: functions are composed from right to left!&apos;);
  }

  throw err;
}

const callees = fastestCar.callees || [];

assert.arrayEqual(
  callees.slice(0, 3),
  [&apos;sortBy&apos;, &apos;last&apos;, &apos;prop&apos;],
  &apos;The answer is incorrect; hint: Hindley-Milner signatures help a lot to reason about composition!&apos;,
);</pre>
	
	<pre class="hidden code-context">// NOTE We keep named function here to leverage this in the `compose` function,
// and later on in the validations scripts.

/* eslint-disable prefer-arrow-callback */


/* ---------- Internals ---------- */

function namedAs(value, fn) {
  Object.defineProperty(fn, &apos;name&apos;, { value });
  return fn;
}


// NOTE This file is loaded by gitbook&apos;s exercises plugin. When it does, there&apos;s an
// `assert` function available in the global scope.

/* eslint-disable no-undef, global-require */
if (typeof assert !== &apos;function&apos; &amp;&amp; typeof require === &apos;function&apos;) {
  global.assert = require(&apos;assert&apos;);
}

assert.arrayEqual = function assertArrayEqual(actual, expected, message = &apos;arrayEqual&apos;) {
  if (actual.length !== expected.length) {
    throw new Error(message);
  }

  for (let i = 0; i &lt; expected.length; i += 1) {
    if (expected[i] !== actual[i]) {
      throw new Error(message);
    }
  }
};
/* eslint-enable no-undef, global-require */


function inspect(x) {
  if (x &amp;&amp; typeof x.inspect === &apos;function&apos;) {
    return x.inspect();
  }

  function inspectFn(f) {
    return f.name ? f.name : f.toString();
  }

  function inspectTerm(t) {
    switch (typeof t) {
      case &apos;string&apos;:
        return `&apos;${t}&apos;`;
      case &apos;object&apos;: {
        const ts = Object.keys(t).map(k =&gt; [k, inspect(t[k])]);
        return `{${ts.map(kv =&gt; kv.join(&apos;: &apos;)).join(&apos;, &apos;)}}`;
      }
      default:
        return String(t);
    }
  }

  function inspectArgs(args) {
    return Array.isArray(args) ? `[${args.map(inspect).join(&apos;, &apos;)}]` : inspectTerm(args);
  }

  return (typeof x === &apos;function&apos;) ? inspectFn(x) : inspectArgs(x);
}


/* eslint-disable no-param-reassign */
function withSpyOn(prop, obj, fn) {
  const orig = obj[prop];
  let called = false;
  obj[prop] = function spy(...args) {
    called = true;
    return orig.call(this, ...args);
  };
  fn();
  obj[prop] = orig;
  return called;
}
/* eslint-enable no-param-reassign */


const typeMismatch = (src, got, fn) =&gt; `Type Mismatch in function &apos;${fn}&apos;

        ${fn} :: ${got}

      instead of

        ${fn} :: ${src}`;


const capitalize = s =&gt; `${s[0].toUpperCase()}${s.substring(1)}`;


const ordinal = (i) =&gt; {
  switch (i) {
    case 1:
      return &apos;1st&apos;;
    case 2:
      return &apos;2nd&apos;;
    case 3:
      return &apos;3rd&apos;;
    default:
      return `${i}th`; // NOTE won&apos;t get any much bigger ...
  }
};

const getType = (x) =&gt; {
  if (x === null) {
    return &apos;Null&apos;;
  }

  if (typeof x === &apos;undefined&apos;) {
    return &apos;()&apos;;
  }

  if (Array.isArray(x)) {
    return `[${x[0] ? getType(x[0]) : &apos;?&apos;}]`;
  }

  if (typeof x.getType === &apos;function&apos;) {
    return x.getType();
  }

  if (x.constructor &amp;&amp; x.constructor.name) {
    return x.constructor.name;
  }

  return capitalize(typeof x);
};


/* ---------- Essential FP Functions ---------- */

// NOTE A slightly pumped up version of `curry` which also keeps track of
// whether a function was called partially or with all its arguments at once.
// This is useful to provide insights during validation of exercises.
function curry(fn) {
  assert(
    typeof fn === &apos;function&apos;,
    typeMismatch(&apos;function -&gt; ?&apos;, [getType(fn), &apos;?&apos;].join(&apos; -&gt; &apos;), &apos;curry&apos;),
  );

  const arity = fn.length;

  return namedAs(fn.name, function $curry(...args) {
    $curry.partially = this &amp;&amp; this.partially;

    if (args.length &lt; arity) {
      return namedAs(fn.name, $curry.bind({ partially: true }, ...args));
    }

    return fn.call(this || { partially: false }, ...args);
  });
}


// NOTE A slightly pumped up version of `compose` which also keeps track of the chain
// of callees. In the end, a function created with `compose` holds a `callees` variable
// with the list of all the callees&apos; names.
// This is useful to provide insights during validation of exercises
function compose(...fns) {
  const n = fns.length;

  return function $compose(...args) {
    $compose.callees = [];

    let $args = args;

    for (let i = n - 1; i &gt;= 0; i -= 1) {
      const fn = fns[i];

      assert(
        typeof fn === &apos;function&apos;,
        `Invalid Composition: ${ordinal(n - i)} element in a composition isn&apos;t a function`,
      );

      $compose.callees.push(fn.name);
      $args = [fn.call(null, ...$args)];
    }

    return $args[0];
  };
}


/* ---------- Algebraic Data Structures ---------- */

class Either {
  static of(x) {
    return new Right(x); // eslint-disable-line no-use-before-define
  }

  constructor(x) {
    this.$value = x;
  }
}


class Left extends Either {
  get isLeft() { // eslint-disable-line class-methods-use-this
    return true;
  }

  get isRight() { // eslint-disable-line class-methods-use-this
    return false;
  }

  ap() {
    return this;
  }

  chain() {
    return this;
  }

  inspect() {
    return `Left(${inspect(this.$value)})`;
  }

  getType() {
    return `(Either ${getType(this.$value)} ?)`;
  }

  join() {
    return this;
  }

  map() {
    return this;
  }

  sequence(of) {
    return of(this);
  }

  traverse(of, fn) {
    return of(this);
  }
}


class Right extends Either {
  get isLeft() { // eslint-disable-line class-methods-use-this
    return false;
  }

  get isRight() { // eslint-disable-line class-methods-use-this
    return true;
  }

  ap(f) {
    return f.map(this.$value);
  }

  chain(fn) {
    return fn(this.$value);
  }

  inspect() {
    return `Right(${inspect(this.$value)})`;
  }

  getType() {
    return `(Either ? ${getType(this.$value)})`;
  }

  join() {
    return this.$value;
  }

  map(fn) {
    return Either.of(fn(this.$value));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    fn(this.$value).map(Either.of);
  }
}


class Identity {
  static of(x) {
    return new Identity(x);
  }

  constructor(x) {
    this.$value = x;
  }

  ap(f) {
    return f.map(this.$value);
  }

  chain(fn) {
    return this.map(fn).join();
  }

  inspect() {
    return `Identity(${inspect(this.$value)})`;
  }

  getType() {
    return `(Identity ${getType(this.$value)})`;
  }

  join() {
    return this.$value;
  }

  map(fn) {
    return Identity.of(fn(this.$value));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return fn(this.$value).map(Identity.of);
  }
}

class IO {
  static of(x) {
    return new IO(() =&gt; x);
  }

  constructor(io) {
    assert(
      typeof io === &apos;function&apos;,
      &apos;invalid `io` operation given to IO constructor. Use `IO.of` if you want to lift a value in a default minimal IO context.&apos;,
    );

    this.unsafePerformIO = io;
  }

  ap(f) {
    return this.chain(fn =&gt; f.map(fn));
  }

  chain(fn) {
    return this.map(fn).join();
  }

  inspect() {
    return `IO(${inspect(this.unsafePerformIO())})`;
  }

  getType() {
    return `(IO ${getType(this.unsafePerformIO())})`;
  }


  join() {
    return this.unsafePerformIO();
  }

  map(fn) {
    return new IO(compose(fn, this.unsafePerformIO));
  }
}


class Map {
  constructor(x) {
    assert(
      typeof x === &apos;object&apos; &amp;&amp; x !== null,
      &apos;tried to create `Map` with non object-like&apos;,
    );

    this.$value = x;
  }

  inspect() {
    return `Map(${inspect(this.$value)})`;
  }

  getType() {
    const sample = this.$value[Object.keys(this.$value)[0]];

    return `(Map String ${sample ? getType(sample) : &apos;?&apos;})`;
  }

  insert(k, v) {
    const singleton = {};
    singleton[k] = v;
    return new Map(Object.assign({}, this.$value, singleton));
  }

  reduce(fn, zero) {
    return this.reduceWithKeys((acc, _, k) =&gt; fn(acc, k), zero);
  }

  reduceWithKeys(fn, zero) {
    return Object.keys(this.$value)
      .reduce((acc, k) =&gt; fn(acc, this.$value[k], k), zero);
  }

  map(fn) {
    return new Map(this.reduceWithKeys((obj, v, k) =&gt; {
      obj[k] = fn(v); // eslint-disable-line no-param-reassign
      return obj;
    }, {}));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return this.reduceWithKeys(
      (f, a, k) =&gt; fn(a).map(b =&gt; m =&gt; m.insert(k, b)).ap(f),
      of(new Map({})),
    );
  }
}


class List {
  static of(x) {
    return new List([x]);
  }

  constructor(xs) {
    assert(
      Array.isArray(xs),
      &apos;tried to create `List` from non-array&apos;,
    );

    this.$value = xs;
  }

  concat(x) {
    return new List(this.$value.concat(x));
  }

  inspect() {
    return `List(${inspect(this.$value)})`;
  }

  getType() {
    const sample = this.$value[0];

    return `(List ${sample ? getType(sample) : &apos;?&apos;})`;
  }

  map(fn) {
    return new List(this.$value.map(fn));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return this.$value.reduce(
      (f, a) =&gt; fn(a).map(b =&gt; bs =&gt; bs.concat(b)).ap(f),
      of(new List([])),
    );
  }
}


class Maybe {
  static of(x) {
    return new Maybe(x);
  }

  get isNothing() {
    return this.$value === null || this.$value === undefined;
  }

  get isJust() {
    return !this.isNothing;
  }

  constructor(x) {
    this.$value = x;
  }

  ap(f) {
    return this.isNothing ? this : f.map(this.$value);
  }

  chain(fn) {
    return this.map(fn).join();
  }

  inspect() {
    return this.isNothing ? &apos;Nothing&apos; : `Just(${inspect(this.$value)})`;
  }

  getType() {
    return `(Maybe ${this.isJust ? getType(this.$value) : &apos;?&apos;})`;
  }

  join() {
    return this.isNothing ? this : this.$value;
  }

  map(fn) {
    return this.isNothing ? this : Maybe.of(fn(this.$value));
  }

  sequence(of) {
    return this.traverse(of, x =&gt; x);
  }

  traverse(of, fn) {
    return this.isNothing ? of(this) : fn(this.$value).map(Maybe.of);
  }
}


class Task {
  constructor(fork) {
    assert(
      typeof fork === &apos;function&apos;,
      &apos;invalid `fork` operation given to Task constructor. Use `Task.of` if you want to lift a value in a default minimal Task context.&apos;,
    );

    this.fork = fork;
  }

  static of(x) {
    return new Task((_, resolve) =&gt; resolve(x));
  }

  static rejected(x) {
    return new Task((reject, _) =&gt; reject(x));
  }

  ap(f) {
    return this.chain(fn =&gt; f.map(fn));
  }

  chain(fn) {
    return new Task((reject, resolve) =&gt; this.fork(reject, x =&gt; fn(x).fork(reject, resolve)));
  }

  inspect() { // eslint-disable-line class-methods-use-this
    return &apos;Task(?)&apos;;
  }

  getType() { // eslint-disable-line class-methods-use-this
    return &apos;(Task ? ?)&apos;;
  }

  join() {
    return this.chain(x =&gt; x);
  }

  map(fn) {
    return new Task((reject, resolve) =&gt; this.fork(reject, compose(resolve, fn)));
  }
}

// In nodejs the existance of a class method named `inspect` will trigger a deprecation warning
// when passing an instance to `console.log`:
// `(node:3845) [DEP0079] DeprecationWarning: Custom inspection function on Objects via .inspect() is deprecated`
// The solution is to alias the existing inspect method with the special inspect symbol exported by node
if (typeof module !== &apos;undefined&apos; &amp;&amp; typeof this !== &apos;undefined&apos; &amp;&amp; this.module !== module) {
  const customInspect = require(&apos;util&apos;).inspect.custom;
  const assignCustomInspect = it =&gt; it.prototype[customInspect] = it.prototype.inspect;
  [Left, Right, Identity, IO, Map, List, Maybe, Task].forEach(assignCustomInspect);
}

const identity = function identity(x) { return x; };

const either = curry(function either(f, g, e) {
  if (e.isLeft) {
    return f(e.$value);
  }

  return g(e.$value);
});

const left = function left(x) { return new Left(x); };

const maybe = curry(function maybe(v, f, m) {
  if (m.isNothing) {
    return v;
  }

  return f(m.$value);
});

const nothing = Maybe.of(null);

const reject = function reject(x) { return Task.rejected(x); };

const chain = curry(function chain(fn, m) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; typeof m.chain === &apos;function&apos;,
    typeMismatch(&apos;Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m a&apos;, [getType(fn), getType(m), &apos;m a&apos;].join(&apos; -&gt; &apos;), &apos;chain&apos;),
  );

  return m.chain(fn);
});

const join = function join(m) {
  assert(
    typeof m.chain === &apos;function&apos;,
    typeMismatch(&apos;Monad m =&gt; m (m a) -&gt; m a&apos;, [getType(m), &apos;m a&apos;].join(&apos; -&gt; &apos;), &apos;join&apos;),
  );

  return m.join();
};

const map = curry(function map(fn, f) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; typeof f.map === &apos;function&apos;,
    typeMismatch(&apos;Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b&apos;, [getType(fn), getType(f), &apos;f b&apos;].join(&apos; -&gt; &apos;), &apos;map&apos;),
  );

  return f.map(fn);
});

const sequence = curry(function sequence(of, x) {
  assert(
    typeof of === &apos;function&apos; &amp;&amp; typeof x.sequence === &apos;function&apos;,
    typeMismatch(&apos;(Applicative f, Traversable t) =&gt; (a -&gt; f a) -&gt; t (f a) -&gt; f (t a)&apos;, [getType(of), getType(x), &apos;f (t a)&apos;].join(&apos; -&gt; &apos;), &apos;sequence&apos;),
  );

  return x.sequence(of);
});

const traverse = curry(function traverse(of, fn, x) {
  assert(
    typeof of === &apos;function&apos; &amp;&amp; typeof fn === &apos;function&apos; &amp;&amp; typeof x.traverse === &apos;function&apos;,
    typeMismatch(
      &apos;(Applicative f, Traversable t) =&gt; (a -&gt; f a) -&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)&apos;,
      [getType(of), getType(fn), getType(x), &apos;f (t b)&apos;].join(&apos; -&gt; &apos;),
      &apos;traverse&apos;,
    ),
  );

  return x.traverse(of, fn);
});

const unsafePerformIO = function unsafePerformIO(io) {
  assert(
    io instanceof IO,
    typeMismatch(&apos;IO a&apos;, getType(io), &apos;unsafePerformIO&apos;),
  );

  return io.unsafePerformIO();
};

const liftA2 = curry(function liftA2(fn, a1, a2) {
  assert(
    typeof fn === &apos;function&apos;
      &amp;&amp; typeof a1.map === &apos;function&apos;
      &amp;&amp; typeof a2.ap === &apos;function&apos;,
    typeMismatch(&apos;Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c&apos;, [getType(fn), getType(a1), getType(a2)].join(&apos; -&gt; &apos;), &apos;liftA2&apos;),
  );

  return a1.map(fn).ap(a2);
});

const liftA3 = curry(function liftA3(fn, a1, a2, a3) {
  assert(
    typeof fn === &apos;function&apos;
      &amp;&amp; typeof a1.map === &apos;function&apos;
      &amp;&amp; typeof a2.ap === &apos;function&apos;
      &amp;&amp; typeof a3.ap === &apos;function&apos;,
    typeMismatch(&apos;Applicative f =&gt; (a -&gt; b -&gt; c -&gt; d) -&gt; f a -&gt; f b -&gt; f c -&gt; f d&apos;, [getType(fn), getType(a1), getType(a2)].join(&apos; -&gt; &apos;), &apos;liftA2&apos;),
  );

  return a1.map(fn).ap(a2).ap(a3);
});

const always = curry(function always(a, b) { return a; });


/* ---------- Pointfree Classic Utilities ---------- */

const append = curry(function append(a, b) {
  assert(
    typeof a === &apos;string&apos; &amp;&amp; typeof b === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String -&gt; String&apos;, [getType(a), getType(b), &apos;String&apos;].join(&apos; -&gt; &apos;), &apos;concat&apos;),
  );

  return b.concat(a);
});

const add = curry(function add(a, b) {
  assert(
    typeof a === &apos;number&apos; &amp;&amp; typeof b === &apos;number&apos;,
    typeMismatch(&apos;Number -&gt; Number -&gt; Number&apos;, [getType(a), getType(b), &apos;Number&apos;].join(&apos; -&gt; &apos;), &apos;add&apos;),
  );

  return a + b;
});

const concat = curry(function concat(a, b) {
  assert(
    typeof a === &apos;string&apos; &amp;&amp; typeof b === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String -&gt; String&apos;, [getType(a), getType(b), &apos;String&apos;].join(&apos; -&gt; &apos;), &apos;concat&apos;),
  );

  return a.concat(b);
});

const eq = curry(function eq(a, b) {
  assert(
    getType(a) === getType(b),
    typeMismatch(&apos;a -&gt; a -&gt; Boolean&apos;, [getType(a), getType(b), &apos;Boolean&apos;].join(&apos; -&gt; &apos;), eq),
  );

  return a === b;
});

const filter = curry(function filter(fn, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;(a -&gt; Boolean) -&gt; [a] -&gt; [a]&apos;, [getType(fn), getType(xs), getType(xs)].join(&apos; -&gt; &apos;), &apos;filter&apos;),
  );

  return xs.filter(fn);
});

const flip = curry(function flip(fn, a, b) {
  assert(
    typeof fn === &apos;function&apos;,
    typeMismatch(&apos;(a -&gt; b) -&gt; (b -&gt; a)&apos;, [getType(fn), &apos;(b -&gt; a)&apos;].join(&apos; -&gt; &apos;), &apos;flip&apos;),
  );

  return fn(b, a);
});

const forEach = curry(function forEach(fn, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;(a -&gt; ()) -&gt; [a] -&gt; ()&apos;, [getType(fn), getType(xs), &apos;()&apos;].join(&apos; -&gt; &apos;), &apos;forEach&apos;),
  );

  xs.forEach(fn);
});

const intercalate = curry(function intercalate(str, xs) {
  assert(
    typeof str === &apos;string&apos; &amp;&amp; Array.isArray(xs) &amp;&amp; (xs.length === 0 || typeof xs[0] === &apos;string&apos;),
    typeMismatch(&apos;String -&gt; [String] -&gt; String&apos;, [getType(str), getType(xs), &apos;String&apos;].join(&apos; -&gt; &apos;), &apos;intercalate&apos;),
  );

  return xs.join(str);
});

const head = function head(xs) {
  assert(
    Array.isArray(xs) || typeof xs === &apos;string&apos;,
    typeMismatch(&apos;[a] -&gt; a&apos;, [getType(xs), &apos;a&apos;].join(&apos; -&gt; &apos;), &apos;head&apos;),
  );

  return xs[0];
};

const last = function last(xs) {
  assert(
    Array.isArray(xs) || typeof xs === &apos;string&apos;,
    typeMismatch(&apos;[a] -&gt; a&apos;, [getType(xs), &apos;a&apos;].join(&apos; -&gt; &apos;), &apos;last&apos;),
  );

  return xs[xs.length - 1];
};

const match = curry(function match(re, str) {
  assert(
    re instanceof RegExp &amp;&amp; typeof str === &apos;string&apos;,
    typeMismatch(&apos;RegExp -&gt; String -&gt; Boolean&apos;, [getType(re), getType(str), &apos;Boolean&apos;].join(&apos; -&gt; &apos;), &apos;match&apos;),
  );

  return re.test(str);
});

const prop = curry(function prop(p, obj) {
  assert(
    typeof p === &apos;string&apos; &amp;&amp; typeof obj === &apos;object&apos; &amp;&amp; obj !== null,
    typeMismatch(&apos;String -&gt; Object -&gt; a&apos;, [getType(p), getType(obj), &apos;a&apos;].join(&apos; -&gt; &apos;), &apos;prop&apos;),
  );

  return obj[p];
});

const reduce = curry(function reduce(fn, zero, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;(b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b&apos;, [getType(fn), getType(zero), getType(xs), &apos;b&apos;].join(&apos; -&gt; &apos;), &apos;reduce&apos;),
  );

  return xs.reduce(
    function $reduceIterator($acc, $x) { return fn($acc, $x); },
    zero,
  );
});

const safeHead = namedAs(&apos;safeHead&apos;, compose(Maybe.of, head));

const safeProp = curry(function safeProp(p, obj) { return Maybe.of(prop(p, obj)); });

const sortBy = curry(function sortBy(fn, xs) {
  assert(
    typeof fn === &apos;function&apos; &amp;&amp; Array.isArray(xs),
    typeMismatch(&apos;Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]&apos;, [getType(fn), getType(xs), &apos;[a]&apos;].join(&apos; -&gt; &apos;), &apos;sortBy&apos;),
  );

  return xs.sort((a, b) =&gt; {
    if (fn(a) === fn(b)) {
      return 0;
    }

    return fn(a) &gt; fn(b) ? 1 : -1;
  });
});

const split = curry(function split(s, str) {
  assert(
    typeof s === &apos;string&apos; &amp;&amp; typeof str === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String -&gt; [String]&apos;, [getType(s), getType(str), &apos;[String]&apos;].join(&apos; -&gt; &apos;), &apos;split&apos;),
  );

  return str.split(s);
});

const take = curry(function take(n, xs) {
  assert(
    typeof n === &apos;number&apos; &amp;&amp; (Array.isArray(xs) || typeof xs === &apos;string&apos;),
    typeMismatch(&apos;Number -&gt; [a] -&gt; [a]&apos;, [getType(n), getType(xs), getType(xs)].join(&apos; -&gt; &apos;), &apos;take&apos;),
  );

  return xs.slice(0, n);
});

const toLowerCase = function toLowerCase(s) {
  assert(
    typeof s === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String&apos;, [getType(s), &apos;?&apos;].join(&apos; -&gt; &apos;), &apos;toLowerCase&apos;),
  );

  return s.toLowerCase();
};

const toUpperCase = function toUpperCase(s) {
  assert(
    typeof s === &apos;string&apos;,
    typeMismatch(&apos;String -&gt; String&apos;, [getType(s), &apos;?&apos;].join(&apos; -&gt; &apos;), &apos;toLowerCase&apos;),
  );

  return s.toUpperCase();
};


/* ---------- Chapter 4 ---------- */

const keepHighest = function keepHighest(x, y) {
  try {
    keepHighest.calledBy = keepHighest.caller;
  } catch (err) {
    // NOTE node.js runs in strict mode and prohibit the usage of &apos;.caller&apos;
    // There&apos;s a ugly hack to retrieve the caller from stack trace.
    const [, caller] = /at (\S+)/.exec(err.stack.split(&apos;\n&apos;)[2]);

    keepHighest.calledBy = namedAs(caller, () =&gt; {});
  }

  return x &gt;= y ? x : y;
};


/* ---------- Chapter 5 ---------- */

const cars = [{
  name: &apos;Ferrari FF&apos;,
  horsepower: 660,
  dollar_value: 700000,
  in_stock: true,
}, {
  name: &apos;Spyker C12 Zagato&apos;,
  horsepower: 650,
  dollar_value: 648000,
  in_stock: false,
}, {
  name: &apos;Jaguar XKR-S&apos;,
  horsepower: 550,
  dollar_value: 132000,
  in_stock: true,
}, {
  name: &apos;Audi R8&apos;,
  horsepower: 525,
  dollar_value: 114200,
  in_stock: false,
}, {
  name: &apos;Aston Martin One-77&apos;,
  horsepower: 750,
  dollar_value: 1850000,
  in_stock: true,
}, {
  name: &apos;Pagani Huayra&apos;,
  horsepower: 700,
  dollar_value: 1300000,
  in_stock: false,
}];

const average = function average(xs) {
  return xs.reduce(add, 0) / xs.length;
};


/* ---------- Chapter 8 ---------- */

const albert = {
  id: 1,
  active: true,
  name: &apos;Albert&apos;,
  address: {
    street: {
      number: 22,
      name: &apos;Walnut St&apos;,
    },
  },
};

const gary = {
  id: 2,
  active: false,
  name: &apos;Gary&apos;,
  address: {
    street: {
      number: 14,
    },
  },
};

const theresa = {
  id: 3,
  active: true,
  name: &apos;Theresa&apos;,
};

const yi = { id: 4, name: &apos;Yi&apos;, active: true };

const showWelcome = namedAs(&apos;showWelcome&apos;, compose(concat(&apos;Welcome &apos;), prop(&apos;name&apos;)));

const checkActive = function checkActive(user) {
  return user.active
    ? Either.of(user)
    : left(&apos;Your account is not active&apos;);
};

const save = function save(user) {
  return new IO(() =&gt; Object.assign({}, user, { saved: true }));
};

const validateUser = curry(function validateUser(validate, user) {
  return validate(user).map(_ =&gt; user); // eslint-disable-line no-unused-vars
});


/* ---------- Chapter 9 ---------- */

const getFile = IO.of(&apos;/home/mostly-adequate/ch09.md&apos;);

const pureLog = function pureLog(str) { return new IO(() =&gt; { console.log(str); return str; }); };

const addToMailingList = function addToMailingList(email) { return IO.of([email]); };

const emailBlast = function emailBlast(list) { return IO.of(list.join(&apos;,&apos;)); };

const validateEmail = function validateEmail(x) {
  return /\S+@\S+\.\S+/.test(x)
    ? Either.of(x)
    : left(&apos;invalid email&apos;);
};


/* ---------- Chapter 10 ---------- */

const localStorage = { player1: albert, player2: theresa };

const game = curry(function game(p1, p2) { return `${p1.name} vs ${p2.name}`; });

const getFromCache = function getFromCache(x) { return new IO(() =&gt; localStorage[x]); };


/* ---------- Chapter 11 ---------- */

const findUserById = function findUserById(id) {
  switch (id) {
    case 1:
      return Task.of(Either.of(albert));

    case 2:
      return Task.of(Either.of(gary));

    case 3:
      return Task.of(Either.of(theresa));

    default:
      return Task.of(left(&apos;not found&apos;));
  }
};

const eitherToTask = namedAs(&apos;eitherToTask&apos;, either(Task.rejected, Task.of));


/* ---------- Chapter 12 ---------- */

const httpGet = function httpGet(route) { return Task.of(`json for ${route}`); };

const routes = new Map({
  &apos;/&apos;: &apos;/&apos;,
  &apos;/about&apos;: &apos;/about&apos;,
});

const validate = function validate(player) {
  return player.name
    ? Either.of(player)
    : left(&apos;must have name&apos;);
};

const readdir = function readdir(dir) {
  return Task.of([&apos;file1&apos;, &apos;file2&apos;, &apos;file3&apos;]);
};

const readfile = curry(function readfile(encoding, file) {
  return Task.of(`content of ${file} (${encoding})`);
});


/* ---------- Exports ---------- */

if (typeof module === &apos;object&apos;) {
  module.exports = {
    // Utils
    withSpyOn,

    // Essential FP helpers
    always,
    compose,
    curry,
    either,
    identity,
    inspect,
    left,
    liftA2,
    liftA3,
    maybe,
    nothing,
    reject,

    // Algebraic Data Structures
    Either,
    IO,
    Identity,
    Left,
    List,
    Map,
    Maybe,
    Right,
    Task,

    // Currified version of &apos;standard&apos; functions
    append,
    add,
    chain,
    concat,
    eq,
    filter,
    flip,
    forEach,
    head,
    intercalate,
    join,
    last,
    map,
    match,
    prop,
    reduce,
    safeHead,
    safeProp,
    sequence,
    sortBy,
    split,
    take,
    toLowerCase,
    toUpperCase,
    traverse,
    unsafePerformIO,

    // Chapter 04
    keepHighest,

    // Chapter 05
    cars,
    average,

    // Chapter 08
    albert,
    gary,
    theresa,
    yi,
    showWelcome,
    checkActive,
    save,
    validateUser,

    // Chapter 09
    getFile,
    pureLog,
    addToMailingList,
    emailBlast,
    validateEmail,

    // Chapter 10
    localStorage,
    getFromCache,
    game,

    // Chapter 11
    findUserById,
    eitherToTask,

    // Chapter 12
    httpGet,
    routes,
    validate,
    readdir,
    readfile,
  };
}</pre>
	

	<div class="buttons">
	    <a href="#" class="button size-2 action-submit">Submit</a>
	    <a href="#" class="button size-2 action-solution">Solution</a>
	</div>
</div>  </p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="ch04.md-kr#연습문제" class="navigation navigation-prev " aria-label="Previous page: 연습문제">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="ch05.html#functional-husbandry" class="navigation navigation-next " aria-label="Next page: Functional Husbandry">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Chapter 05: Coding by Composing","level":"1.6","depth":1,"next":{"title":"Functional Husbandry","level":"1.6.1","depth":2,"anchor":"#functional-husbandry","path":"ch05.md","ref":"ch05.md#functional-husbandry","articles":[]},"previous":{"title":"연습문제","level":"1.5.4","depth":2,"anchor":"#연습문제","path":"ch04.md-kr","ref":"ch04.md-kr#연습문제","articles":[]},"dir":"ltr"},"config":{"plugins":["exercises@git+https://github.com/MostlyAdequate/plugin-exercises.git","include-codeblock@3.1.2"],"root":".","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"exercises":{},"include-codeblock":{"check":false,"edit":false,"lang":"","fixlang":false,"template":"default","theme":"chrome","unindent":false},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"cover":"images/cover.png","title":"Professor Frisby's Mostly Adequate Guide to Functional Programming","gitbook":"3.2.2"},"file":{"path":"ch05.md","mtime":"2023-03-16T13:34:28.228Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2023-03-16T13:35:26.336Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook-plugin-exercises/jsrepl/jsrepl.js" id="jsrepl-script"></script>
    
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-exercises/ace/ace.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-exercises/ace/theme-tomorrow.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-exercises/ace/mode-javascript.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-exercises/exercises.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    


    </body>
</html>

